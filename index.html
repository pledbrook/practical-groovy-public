<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Practical Groovy</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-right">
<div id="header">
<h1>Practical Groovy</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_who_this_book_is_for">1. Who this book is for</a></li>
<li><a href="#_first_steps">2. First steps</a>
<ul class="sectlevel2">
<li><a href="#_installing_groovy">2.1. Installing Groovy</a></li>
<li><a href="#_groovy_as_a_calculator">2.2. Groovy as a calculator</a></li>
</ul>
</li>
<li><a href="#_working_with_types">3. Working with types</a>
<ul class="sectlevel2">
<li><a href="#_the_joy_of_strings">3.1. The joy of strings</a></li>
<li><a href="#_collections_ranges_and_maps">3.2. Collections, ranges and maps</a></li>
<li><a href="#_chapter_example">3.3. Chapter example</a></li>
</ul>
</li>
<li><a href="#_doing_odd_jobs_scripting">4. Doing odd jobs (scripting)</a>
<ul class="sectlevel2">
<li><a href="#_working_with_the_filesystem">4.1. Working with the filesystem</a></li>
<li><a href="#_dates_and_time">4.2. Dates and time</a></li>
<li><a href="#_closures">4.3. Closures</a></li>
<li><a href="#_revisiting_earlier_examples">4.4. Revisiting earlier examples</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_who_this_book_is_for">1. Who this book is for</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the struggles for any author is identifying who the target audience is. Novice or expert? Computer literate or not? In the end, a book cannot satisfy everyone and any attempt to do so will result in failure.</p>
</div>
<div class="paragraph">
<p>Practical Groovy is designed to be an introduction to the Groovy programming language for anyone that has prior knowledge of an object-oriented language, such as Java or Python. Familiarity with the Java platform will certainly help you, but it&#8217;s not absolutely necessary. As long as you can install the Java Development Kit, you&#8217;re good to go.</p>
</div>
<div class="paragraph">
<p>I envisage two main classes of existing developer using this book:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Dynamic language programmers that want to migrate to the Java platform while continuing to use features that they&#8217;re used to.</p>
</li>
<li>
<p>Java developers that want some of the productivity promised by Groovy while staying on a familiar platform (including the core class library).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The book will take you through lots of practical examples so that you get a good understanding of how Groovy differs from other languages and how you might solve particular problems. It&#8217;s best read while you are working on a computer so that you can try the examples out as you come across them. It also gives you the opportunity to experiment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_first_steps">2. First steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the tech world, it&#8217;s fairly common to hear the phrase "yak shaving". This represents the kind of situation in which you end up doing a lot of setup work in order to achieve what you originally intended. In the case of Groovy, it normally entails installing the Java Development Kit if you haven&#8217;t already done so, followed by Groovy itself. Fortunately, you can bypass all that by using the Groovy Web Console, which is a browser-based application for executing Groovy scripts.</p>
</div>
<div class="paragraph">
<p>You can find the app at the address <a href="http://groovyconsole.appspot.com/" class="bare">http://groovyconsole.appspot.com/</a>. You should see the page shown in figure 1.1.</p>
</div>
<div class="paragraph">
<p>The text editor component allows you to write Groovy that you can then execute. Try it now by entering the code</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="integer">12</span> + <span class="integer">5</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>and clicking on the Execute script link. You&#8217;ll see the result "17" displayed in the Result tab.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s now try the classic Hello World example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world!</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now when you execute the script you&#8217;ll see the "Hello world!" text displayed in the Output tab. What&#8217;s the difference between the two tabs? The Result tab displays the value of the last expression in the script, whereas the Output tab displays anything that would normally go to the terminal or command prompt (stdout in C parlance). You can test this out by adding the "12 + 5" line to the end of the Hello World script: you should see something in both the Result tab and the Output tab.</p>
</div>
<div class="paragraph">
<p>At this point, you have two choices:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Continue with the Groovy Web Console for now and skip to section TODO</p>
</li>
<li>
<p>Read the next section on installing Groovy on your own computer</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You will want to install Groovy at some point and it&#8217;s usually a straightforward process. On the other hand, it is an extra step that you may not need just to get started with the language. If you want to be able to work offline or run scripts locally, then you should definitely install Groovy now. Otherwise either option is fine.</p>
</div>
<div class="sect2">
<h3 id="_installing_groovy">2.1. Installing Groovy</h3>
<div class="paragraph">
<p>Before I explain how to install and set up Groovy, consider this: why would you need to install anything? This is an important question as you don&#8217;t necessarily need a Groovy installation in order to develop with Groovy. Build tools and IDEs can quite happily compile Groovy source files without one. What you absolutely must have, though, is a Java runtime installed.</p>
</div>
<div class="paragraph">
<p>The Java platform comes in several forms, but for the sake of simplicity I want to focus on two of them: the Java Runtime Environment (JRE) and the Java Development Kit (JDK). The first of these allows you to run Java applications and applets (those things that run in a browser and require the Java plugin). The JDK allows you to build Java applications, as well as run them, and it&#8217;s the best option for a Groovy developer.</p>
</div>
<div class="paragraph">
<p>To get hold of the JDK, head to the <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">download page</a> on Oracle&#8217;s website and follow the links. Remember, you only need the basic JDK for your platform. Once you have downloaded the package and installed the JDK (I recommend using an installation path without spaces), you just need to set up an environment variable:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>JAVA_HOME=&lt;path to JDK&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re unsure how to do this, a simple web search for "setting environment variable" combined with your platform will produce plenty of links to help out.</p>
</div>
<div class="paragraph">
<p>That&#8217;s all you need as far as the Java side goes. So what about Groovy? You&#8217;ll need to install it for the purposes of this book because you will need access to the associated tools, in particular the Groovy console. You also need a Groovy installation if you want to run standalone scripts, which comes in very handy.</p>
</div>
<div class="paragraph">
<p>You can install Groovy in a number of ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On Windows, <a href="http://groovy-lang.org/download.html">download and run the installer</a>.</p>
</li>
<li>
<p>On Mac OS X, you can use Homebrew or MacPorts: <code>brew install groovy</code> or <code>sudo port install groovy</code>.</p>
</li>
<li>
<p>On all platforms that have Bash, including Cygwin, you can use the <a href="http://gvmtool.net/">Groovy Environment Manager (GVM)</a>, which allows you to install multiple versions of Groovy as well as other tools such as Grails and Gradle.</p>
</li>
<li>
<p>Alternatively, download the platform-agnostic binary distribution, unpack it, and manually set up the necessary environment variables.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>My preferred option is GVM as it makes installing Groovy trivially easy and new versions of Groovy (including beta and other milestone releases) become available through it promptly. The fact you can have different versions of Groovy active in different terminals is an added bonus.</p>
</div>
<div class="paragraph">
<p>Whichever approach you take, you will end up with a <code>GROOVY_HOME</code> environment variable containing the location of the current Groovy installation. Your <code>PATH</code> environment variable will also include the path to the Groovy installation&#8217;s 'bin' directory, since that&#8217;s where all the useful tools are. You can verify the installation by running</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groovy -e "println 'Hello'"</pre>
</div>
</div>
<div class="paragraph">
<p>in a terminal. If everything is working, this will println the line "Hello" to the terminal. If you instead get an error message about the <code>groovy</code> command not being found, then check your <code>PATH</code> environment variable as it&#8217;s probably not initialized properly.</p>
</div>
<div class="paragraph">
<p>So what does a Groovy installation give you? The main tools of interest are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>groovy</code> - allows you to run Groovy scripts from the command line.</p>
</li>
<li>
<p><code>groovysh</code> - starts an interactive shell for executing Groovy statements.</p>
</li>
<li>
<p><code>groovyConsole</code> - starts a desktop version of the Groovy Web Console, with syntax highlighting in the editor pane.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You will start with the Groovy console as it&#8217;s the easiest way to learn Groovy through practice. Just start it up with the command</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groovyConsole</pre>
</div>
</div>
<div class="paragraph">
<p>and you&#8217;ll then see the window shown in figure 1.3 TODO.</p>
</div>
<div class="paragraph">
<p>The Groovy console has several options available, including loading and saving scripts as well as the standard cut, copy and paste. The most important options are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>View &gt; Clear Output - clears the output pane of any existing text from previous script executions.</p>
</li>
<li>
<p>View &gt; Show Script in Ouput - enabled by default, you should uncheck this so that the output pane isn&#8217;t polluted with the text of the script itself.</p>
</li>
<li>
<p>Script &gt; Run - executes the script.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I recommend you remember the keyboard shortcuts for clearing the output pane and executing the script as you&#8217;ll be using them a lot.</p>
</div>
<div class="paragraph">
<p>You&#8217;re now all set to start coding.</p>
</div>
</div>
<div class="sect2">
<h3 id="_groovy_as_a_calculator">2.2. Groovy as a calculator</h3>
<div class="paragraph">
<p>I&#8217;m sure your OS has a calculator app, as do most smartphones. Still, using Groovy as a calculator is a gentle way to introduce some of the basic syntax and semantics of the language. You already saw a simple addition. What happens if you now try</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="integer">13</span> + <span class="integer">3</span> / <span class="integer">4</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>? In most programming languages you would end up with the result 13.75 (although Java would give you 13), and that&#8217;s exactly what you get with Groovy. In other words, the division has occurred first. To do the sum first, use parentheses to control the order in which the operators are evaluated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">(<span class="integer">13</span> + <span class="integer">3</span>) / <span class="integer">4</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above results in 4. Groovy supports all the usual suspects when it comes to arithmetic operators, such as <code>-</code> (subtract), <code>*</code> (multiply), and <code>%</code> (modulo). Unlike Java, it also supports an exponentiation operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="integer">2</span> ** <span class="integer">8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This gives the result of two to the power of 8. If, like me, you&#8217;ve spent too much time in the past using Visual Basic, note that <code>^</code> does <em>not</em> perform an exponentiation. It&#8217;s the XOR bitwise operator. You can see a complete list of operators in appendix A.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s now introduce some verification into the calculations. First, here is a simple equality comparison:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="integer">8</span> + <span class="integer">4</span> == <span class="integer">12</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The result now is a word: <code>true</code>. This is a literal boolean value whose counterpart, as you&#8217;d expect, is <code>false</code>.</p>
</div>
<div class="paragraph">
<p>To verify that the expression does indeed result in <code>true</code>, you can prefix it with the keyword <code>assert</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">assert</span> <span class="integer">8</span> + <span class="integer">4</span> == <span class="integer">12</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When you run this, nothing different appears to happen. But what if the expression doesn&#8217;t evaluate to <code>true</code>? Try</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">assert</span> <span class="integer">8</span> + <span class="integer">4</span> == <span class="integer">11</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The expression is obviously now false and this time you see an error message:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Assertion failed:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>assert 8 + 4 == 11
         |   |
         12  false</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>at ConsoleScript6.run(ConsoleScript6:1)</pre>
</div>
</div>
<div class="paragraph">
<p>What&#8217;s interesting about this error is that it shows the values of all parts of the expression, including both the left hand and right hand sides. As you might imagine, this makes it relatively easy to diagnose problems in your code. Assertions are particularly useful in unit tests and other verification-based scenarios.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s now try out the Pythagorean Theorem. You do remember that from school, don&#8217;t you? In case it&#8217;s been too long, it states that the square of the hypotenuse of a right-angled triangle is equal to the sum of the squares of the other two sides. In code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> a = <span class="integer">3</span>
<span class="keyword">def</span> b = <span class="integer">4</span>
<span class="keyword">def</span> result = <span class="predefined-type">Math</span>.sqrt(a ** <span class="integer">2</span> + b ** <span class="integer">2</span>)

<span class="keyword">assert</span> result == <span class="integer">5</span>
println result</code></pre>
</div>
</div>
<div class="paragraph">
<p>This little example introduces some new concepts and syntax. First, it declares and uses a few local variables using the keyword <code>def</code>. Variables declared in this way can contain values of any type, not just numbers. In other words, the variables are untyped.</p>
</div>
<div class="paragraph">
<p>The second item of interest is the <code>sqrt()</code> method call. The syntax is absolutely identical to Java&#8217;s and in this case you&#8217;re seeing a <em>static</em> method. This is called on the class itself (<code>lava.lang.Math</code>) rather than on an instance of that class.</p>
</div>
<div class="paragraph">
<p>Last, but not least, the assertion fails to throw an error despite <code>result</code> being a floating point number. Groovy&#8217;s <code>==</code> operator is largely value based so that <code>5</code> and <code>5.0</code> are considered the same despite being different types. This particular behavior is quite different to that of Java, which is very strict on equality.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s another example with some more method calls. It takes a hexidecimal string, converts it to an integer, divides that value by 2 (using integer division) and then prints out the hexidecimal representation of the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> n = <span class="predefined-type">Integer</span>.parseInt(<span class="string"><span class="delimiter">&quot;</span><span class="content">ED59</span><span class="delimiter">&quot;</span></span>, <span class="integer">16</span>)
n = n.intdiv(<span class="integer">2</span>)
println <span class="predefined-type">Integer</span>.toHexString(n)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output is simply the string "76ac". Hexidecimal representations are fairly common in our line of work, so it&#8217;s useful to know that you can easily transform them to and from integers.</p>
</div>
<div class="paragraph">
<p>The above example looks unassuming, but it highlights a common struggle with Groovy: where do these methods come from? And where are they documented? To answer those questions, you first need to know what type you&#8217;re dealing with. With static methods that&#8217;s straightforward as you can see the type directly (<code>Integer</code> in the above example, which is short for <code>java.lang.Integer</code> - the fully qualified class name). It&#8217;s not much harder for instance methods as you can always see the type of an object by calling the method <code>getClass()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="integer">10</span>.getClass()
println <span class="float">1.2</span>.getClass()
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>.getClass()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Executing this simple script results in the following output:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>class java.lang.Integer
class java.math.BigDecimal
class java.lang.String</pre>
</div>
</div>
<div class="paragraph">
<p>All three types are part of the core Java class library, which is fantastic if you already know Java. (And if you already know Java, you might be surprised at the floating point type - I&#8217;ll talk about that soon TODO). What this means for you is that you&#8217;ll need to bookmark the <a href="https://docs.oracle.com/javase/8/docs/api/">Java API documentation</a> when coding in Groovy. You&#8217;ll find the <code>parseInt()</code> and <code>toHexString()</code> methods described under <code>java.lang.Integer</code>. What you won&#8217;t find is the <code>intdiv()</code> method.</p>
</div>
<div class="paragraph">
<p>What? Where does that come from then? One thing you have to remember is that one of Groovy&#8217;s aims is to be as close to Java as possible while providing user-friendly features. What this means in practice is that Groovy extends the core Java class library with methods and properties that it thinks are particularly useful. <code>intdiv()</code> is one of those methods and you can find it nestled away in the <a href="http://docs.groovy-lang.org/docs/next/html/groovy-jdk/">Groovy JDK documentation</a>.</p>
</div>
<div class="paragraph">
<p>The Groovy JDK is the name given to all the extra properties and methods that Groovy adds to the core Java classes. The layout of the documentation is similar to that of the Java API docs, and so you just need to select the Java class you&#8217;re interested in to see what Groovy adds. Look under <a href="http://docs.groovy-lang.org/docs/next/html/groovy-jdk/?java/lang/Number.html"><code>java.lang.Number</code></a> (the super class of <code>Integer</code>) and you&#8217;ll find <code>intdiv()</code>. Unfortunately it&#8217;s not always obvious which type to look at for any given property or method, but it becomes easier as you get to know both Groovy and the Java class library.</p>
</div>
<div class="paragraph">
<p>There may be something nagging you by this point. All the method calls, such as <code>getClass()</code> and <code>sqrt()</code>, have parentheses. So what about <code>println()</code>? Isn&#8217;t that a method call too? If so, where are the parentheses?</p>
</div>
<div class="paragraph">
<p><code>println()</code> is indeed a method call, equivalent to <code>System.out.println()</code> in Java. Unlike any other method, though, it can be called as if it were a global function. It doesn&#8217;t need to be called on an object or class like all other methods. As for the lack of parentheses, Groovy doesn&#8217;t require them in certain circumstances. It&#8217;s too early in your Groovy career to discuss exactly what those circumstances are, so for the moment, use parentheses for all method calls and only leave them out for <code>println()</code> calls.</p>
</div>
<div class="paragraph">
<p>One important point to be aware of is that the parentheses are required if you don&#8217;t pass any arguments to <code>println()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>
println()
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Goodbye</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>What happens if you don&#8217;t have parentheses? Try it out:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>
println
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Goodbye</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You will now see an error message rather than the "Goodbye" text:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groovy.lang.MissingPropertyException: No such property: println for class: hello-goodbye</pre>
</div>
</div>
<div class="paragraph">
<p>Note the class name of the exception: <code>MissingPropertyException</code>. Groovy is looking for a <em>property</em> called <code>println</code>, not a method. I&#8217;ll come to properties soon, but for completeness, try this example where the parentheses are included but the method name is incorrect:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>
print1n()
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Goodbye</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This time, you will see a different error:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groovy.lang.MissingMethodException: No signature of method: hello-goodbye.print1n()
➥ is applicable for argument types: () values: []
Possible solutions: println(), println(), println(java.lang.Object),
➥ println(java.lang.Object), println(java.io.PrintWriter), print(java.lang.Object)
        at hello-goodbye.run(hello-goodbye.groovy:2)</pre>
</div>
</div>
<div class="paragraph">
<p>Note how Groovy is stating that it can&#8217;t find a method this time. It also rather handily displays a list of known methods that are a close match to the unknown method name just in case you have a simple typo or can&#8217;t remember the correct name properly. You should always read the exception messages carefully as they are tremendously useful in determining why something isn&#8217;t working.</p>
</div>
<div class="paragraph">
<p>Another interesting facet of the language is that you&#8217;re seeing runtime errors for unknown methods and properties. This is because Groovy resolves properties and methods at runtime by default rather than at compile time. This can be changed, as you&#8217;ll see in chapter TODO. You can also make use of this runtime resolution to do interesting things such as creating builders (chapter TODO) or mock objects (chapter TODO).</p>
</div>
<div class="paragraph">
<p>Let&#8217;s return to the world of numbers and look at some more examples. In the following script, I perform a floating-point multiplication repeatedly and time how long it takes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> start = <span class="predefined-type">System</span>.currentTimeMillis()  <b class="conum">(1)</b>
<span class="keyword">def</span> n = <span class="float">100.0</span>
<span class="keyword">for</span> (i <span class="keyword">in</span> <span class="integer">0</span>..&lt;<span class="integer">100000</span>) {             <b class="conum">(2)</b>
    n = n * <span class="float">0.95</span>
}

println <span class="string"><span class="delimiter">&quot;</span><span class="content">n = </span><span class="inline"><span class="inline-delimiter">${</span>n<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>                      <b class="conum">(3)</b>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Time taken: </span><span class="inline"><span class="inline-delimiter">${</span>(<span class="predefined-type">System</span>.currentTimeMillis() - start)<span class="inline-delimiter">}</span></span><span class="content">ms</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Gets the current number of milliseconds since the Unix epoch (1st Jan 1970)</p>
</li>
<li>
<p>Iterates over the integers 0 to 100,000</p>
</li>
<li>
<p>Displays the value of <code>n</code> within this string</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ignore the <code>for</code> loop and <code>println()</code> statements for the moment and just focus on the results of executing the script. First, the number it displays is ridiculously long. When you run it, you&#8217;ll see what I mean. Second, it takes a while to finish - around 2.5 seconds on my laptop. Now add a <code>D</code> suffix to the literal <code>100.0</code> and run the script again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
def n = <span class="float">100.0D</span>
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This time the number is significantly shorter and, more to the point, different. The script also finishes much faster - 33ms for me. What&#8217;s going on? It all boils down to the number types being used. When you look at the classes behind the two number literals:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="float">100.0</span>.getClass()
println <span class="float">100.0D</span>.getClass()</code></pre>
</div>
</div>
<div class="paragraph">
<p>you will see that the first value is of type <code>java.math.BigDecimal</code>, while the second one is a <code>java.lang.Double</code>. <code>Double</code> allows for fast calculations at the cost of accuracy, while <code>BigDecimal</code> is accurate at the cost of speed. In fact, <code>Double</code> cannot represent the final result because it&#8217;s too small.</p>
</div>
<div class="paragraph">
<p>As you can guess from running these scripts, Groovy defaults to <code>BigDecimal</code> for floating point literals, which ensures accuracy. This behavior may bother some of you, but it&#8217;s not a big deal. As you can see, it&#8217;s easy to turn floating point literals into <code>Double</code>s through a simple suffix if you have the need for speed.</p>
</div>
<div class="paragraph">
<p>Integer numbers also show some interesting effects. Consider this example for calculating factorials:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">factorial</span>(n) {                            <b class="conum">(1)</b>
    <span class="keyword">return</span> n == <span class="integer">1</span> ? <span class="integer">1</span> : n * factorial(n - <span class="integer">1</span>)  <b class="conum">(2)</b>
}

println factorial(<span class="integer">10</span>)</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Declares a new function called "factorial"</p>
</li>
<li>
<p>Uses the ternary operator ('&lt;condition&gt; ? &lt;value1&gt; : &lt;value2&gt;') for a conditional result</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A quick work on the implementation before we look at the behavior of this script. The easiest way to implement the factorial algorithm is via recursion, and for that you need functions. As you can see from the example, Groovy allows you to define functions in a script using the syntax</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;return type&gt; &lt;method name&gt;(&lt;type&gt; &lt;arg&gt;[, &lt;type&gt; &lt;arg&gt;,...]) {
    &lt;method body&gt;
}</pre>
</div>
</div>
<div class="paragraph">
<p>This is also the basic syntax for defining methods within classes, as you&#8217;ll see later. As with the local variables earlier, the <code>factorial()</code> function doesn&#8217;t specify an explicit type for its return value, using <code>def</code> instead. Once defined, you can then call the function from anywhere inside the script.</p>
</div>
<div class="paragraph">
<p>You might notice that <code>factorial()</code> doesn&#8217;t specify a type for its argument. Nor does it use <code>def</code>. That&#8217;s because method arguments are a special case that don&#8217;t require <code>def</code> if they are untyped. If you forget this, don&#8217;t worry: Groovy happily accepts <code>def</code> in front of method arguments. It&#8217;s just unusual amongst more experienced Groovy developers.</p>
</div>
<div class="paragraph">
<p>Executing the factorial script behaves as you&#8217;d expect, displaying the value 3628800 (everyone knows the factorial of 10, right?). But what if I pass a floating point number to the <code>factorial()</code> function instead?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
println factorial(<span class="float">10.5</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ouch! Now when you run this you&#8217;ll see an ugly <code>StackOverflowError</code>. That&#8217;s because the recursion only stops when <code>n</code> becomes 1, which never happens if the initial argument is not an integer. So if the function only works with integers, can we specify that as a constraint? Indeed we can. Change the signature of the method to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">factorial</span>(<span class="type">int</span> n) {
    ...
}
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The argument is now <em>typed</em>. If you attempt to call the <code>factorial()</code> method with an argument of 10.5 now, you&#8217;ll get a <code>MissingMethodException</code> because Groovy can&#8217;t find a method whose signature accepts floating point numbers. You&#8217;re still seeing a runtime error though, as Groovy doesn&#8217;t perform a compile-time check even though we have specified the types.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Primitive vs object types</div>
<div class="paragraph">
<p>I guess now is as good a time as any to explain why <code>int</code> rather than <code>Integer</code>. Java has the concept of primitive types and object types. Primitive types, such as <code>int</code>, <code>double</code>, etc., are not objects and so you can&#8217;t call methods on them. Nor can they have a value of <code>null</code>. On the plus side, they allow for faster calculations.</p>
</div>
<div class="paragraph">
<p>Groovy has inherited primitive types from Java, but it treats them differently. In fact, the only difference between the primitive and object types is that the former can&#8217;t be <code>null</code>. You can access properties and methods on primitive types just as you can on object types. Because of that, I tend to use the primitive types. It&#8217;s more habit than anything else. That said, it makes sense for <code>factorial()</code> to use the primitive type as the algorithm can&#8217;t handle <code>null</code> values anyway.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Are you happy with the implementation of <code>factorial()</code> as it stands? I&#8217;m not. To understand why, try using a value of 17:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
println factorial(<span class="integer">17</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Were you expecting a negative number? Whether you were or not, that&#8217;s what happens and it&#8217;s certainly not correct. The reason for this is that <code>int</code> and <code>Integer</code> can only store integers up to a size of 2<sup>31</sup>. If your value goes beyond that, then you end up with something called <em>integer overflow</em>.</p>
</div>
<div class="paragraph">
<p>You can force Groovy to use a wider integer type by changing the specified type. Long integers are 64 bit, so that will allow us to calculate larger factorials:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">factorial</span>(<span class="type">long</span> n) {
    ...
}
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unfortunately, it&#8217;s not long before you hit integer overflows again. Just try using a value of 21! The result is negative yet again. This is one occasion where the <code>java.math.BigInteger</code> type is particularly useful. It can handle integers of almost any size. As with <code>BigDecimal</code>, it&#8217;s not as fast as using the core types, but it&#8217;s speedy enough for many cases:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">factorial</span>(<span class="predefined-type">BigInteger</span> n) {
    <span class="keyword">return</span> n == <span class="integer">1</span> ? <span class="integer">1</span> : n * factorial(n - <span class="integer">1</span>)
}

println factorial(<span class="integer">234</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can declare types for local variables and method return values, not just method arguments. Groovy will automatically coerce values to the required type. If a particular coercion isn&#8217;t supported, then you get a runtime error. Type coercion has a lot of subtleties to it, so there&#8217;s a dedicated section for it in chapter TODO.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_types">3. Working with types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Numbers are an important part of programming. Ultimately, computers <em>only</em> deal with numbers. As humans, though, we prefer some higher level types such as strings. In this chapter, I&#8217;ll show you how to use and interact with strings, collections, and maps. I&#8217;ll also introduce some other concepts such as fields and properties.</p>
</div>
<div class="sect2">
<h3 id="_the_joy_of_strings">3.1. The joy of strings</h3>
<div class="paragraph">
<p>History has been recorded in the form of text for thousands of years - in stone, on paper, and now electronically. In that time, words have lost none of their power or usefulness. That&#8217;s why a basic type representing text is such a fundamental part of any programming language. And of course that type should be able to handle any language.</p>
</div>
<div class="paragraph">
<p>Groovy uses Java&#8217;s <a href="https://docs.oracle.com/javase/8/docs/api/?java/lang/String.html"><code>java.lang.String</code></a> class which is able to represent text in any written language supported by Unicode, or more specifically the 16-bit Unicode Transformation Format (UTF-16). If you&#8217;re interested, you can find a full list of supported scripts/alphabets <a href="http://www.unicode.org/standard/supported.html">on the Unicode website</a>. I&#8217;ll be using the latin alphabet almost exclusively in this book, but you can try this short script in the Groovy console to confirm support for other languages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">&quot;</span><span class="content">I live in London</span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">我住在北京</span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">ฉันอาศัยอยู่ในกรุงเทพฯ</span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Ζω στην Αθήνα</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above consists of English, Chinese (Simplified), Thai, and Greek (using Google Translate of course - I only wish I could write in so many diverse languages!). Just bear in mind that you need a text editor or IDE that supports UTF-8 if you want to use non-Latin characters in Groovy source code. This is because the Groovy compiler assumes UTF-8 by default.</p>
</div>
<div class="paragraph">
<p>It&#8217;s quite possible to write a book about character encodings and internationalization, but it&#8217;s out of scope for a Groovy language introduction. So from here on in, I&#8217;ll be sticking to examples based on English. That will certainly make life easy for the next example which will involve some text analysis.</p>
</div>
<div class="sect3">
<h4 id="_strings_are_sequences">3.1.1. Strings are sequences</h4>
<div class="paragraph">
<p>What is text? It&#8217;s inherently a sequence of characters, which means you can evaluate its length, reorder it, extract substrings and count the number of vowels or consonants in it. It also means you can iterate over the characters.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how this works in Groovy. We start with a piece of text (a string), evaluate the properties we just described (length, etc.) and then print that information out:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> text = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Text length: </span><span class="delimiter">&quot;</span></span> + text.size()        <b class="conum">(1)</b>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">First character: </span><span class="delimiter">&quot;</span></span> + text[<span class="integer">0</span>]        <b class="conum">(2)</b>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Last character: </span><span class="delimiter">&quot;</span></span> + text[-<span class="integer">1</span>]

<span class="directive">final</span> vowels = <span class="string"><span class="delimiter">&quot;</span><span class="content">aeiou</span><span class="delimiter">&quot;</span></span>                       <b class="conum">(3)</b>
<span class="keyword">def</span> vowelCount = <span class="integer">0</span>
<span class="keyword">for</span> (ch <span class="keyword">in</span> text) {                           <b class="conum">(4)</b>
    <span class="keyword">if</span> (vowels.contains(ch.toLowerCase())) {
        vowelCount++
    }
}

println <span class="string"><span class="delimiter">&quot;</span><span class="content">Number of vowels: </span><span class="delimiter">&quot;</span></span> + vowelCount</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Concatenate strings with the <code>+</code> operator</p>
</li>
<li>
<p>Access individual characters</p>
</li>
<li>
<p>Declare a constant using <code>final</code></p>
</li>
<li>
<p>Iterate over the characters of the string</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This example introduces several properties of strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Concatenation with <code>+</code></p>
<div class="paragraph">
<p>You can build up strings this way with any values, including numbers, lists and so on. The only requirement is that the concatenation starts with a string.</p>
</div>
</li>
<li>
<p>Text length with <code>size()</code></p>
<div class="paragraph">
<p>Java is annoying because you need to use different fields or methods to get the lengths of arrays, lists, and strings. In Groovy, you can just use the <code>size()</code> method for all types of sequence. You can find this method documented in the <a href="http://docs.groovy-lang.org/docs/next/html/groovy-jdk/?java/lang/String.html">Groovy JDK entry for String</a>.</p>
</div>
</li>
<li>
<p>Array indexing to extract characters</p>
<div class="paragraph">
<p>You can use the syntax of <code>[index]</code> on any type of sequence to pick out a particular element. The first element of a sequence is at index 0. If you want to index from the end of a sequence, use a negative number. So -1 represents the last element, -2 the second to last, and so on.</p>
</div>
<div class="paragraph">
<p>One thing to note is that the array index operator returns a single character string in this case, rather than a <code>java.lang.Character</code>. You can verify this by adding a line <code>println text[0].getClass()</code> to the script. I&#8217;ll discuss the <code>Character</code> type shortly as Groovy is noticeably different from Java on this score.</p>
</div>
</li>
<li>
<p>Looping with <code>for</code></p>
<div class="paragraph">
<p>The standard Groovy <code>for</code> loop works on any type of sequence, just like the array index operator. And similarly, each iteration gives you a single character string to work with instead of a <code>Character</code>. If you want to be more explicit you can include the type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">for</span> (<span class="predefined-type">String</span> ch <span class="keyword">in</span> text) {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This does of course raise the question of when to explicitly specify the type of the iteration variable. It&#8217;s a question that always crops up with Groovy because of its optional typing, hence why I discuss it more thoroughly in chapter [TODO] once you know most of the basics. In this particular case, it&#8217;s easy to infer the type of <code>ch</code> and so the type isn&#8217;t necessary. But some people may be more comfortable with it being explicit, and that&#8217;s fine too.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>I just want to finish off this section by identifying the source of the string methods used in the example. I&#8217;ve already mentioned that <code>size()</code> is provided by the Groovy JDK, but so is <code>toLowerCase()</code>, which returns a new string with all letters lower-cased. The <code>contains()</code> method is different because it is provided by the JDK itself.</p>
</div>
<div class="paragraph">
<p>This sort of thing can be frustrating: how are you supposed to know where to find these methods in the API docs? The best advice is to stay calm and just look at both the Java API and Groovy JDK docs when searching for a method. Alternatively, use an IDE that will give you auto completion: Eclipse, IntelliJ and NetBeans all have great Groovy integration. As you become more familiar with the APIs, you&#8217;ll learn where the various methods come from.</p>
</div>
<div class="paragraph">
<p>Before moving on, there is one improvement I&#8217;d like to make to the script. I like things to be formatted so that they are more readable. The summary of the text analysis just doesn&#8217;t cut it at the moment as the values are misaligned. We can easily remedy that in Groovy using one of its methods related to padding. In this case, we want to pad the labels so that the values all appear left-aligned:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> text = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>
<span class="directive">final</span> padding = <span class="integer">20</span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Text length: </span><span class="delimiter">&quot;</span></span>.padRight(padding) + text.size()
println <span class="string"><span class="delimiter">&quot;</span><span class="content">First character: </span><span class="delimiter">&quot;</span></span>.padRight(padding) + text[<span class="integer">0</span>]
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Last character: </span><span class="delimiter">&quot;</span></span>.padRight(padding) + text[-<span class="integer">1</span>]
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>You could also try right-aligning the labels by using the <code>padLeft()</code> method instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="_string_expansion">3.1.2. String expansion</h4>
<div class="paragraph">
<p>As you&#8217;ve just seen, string concatenation works just fine. That said, it does add noise to your code, particularly when there is more text than expressions. An alternative approach in Groovy is to use string expansion, by embedding expressions inside <code>${}</code> place holders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
println <span class="string"><span class="delimiter">&quot;</span><span class="content">I found </span><span class="inline"><span class="inline-delimiter">${</span>vowelCount<span class="inline-delimiter">}</span></span><span class="content"> vowels in the text</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>I consider this to be more readable than</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
println <span class="string"><span class="delimiter">&quot;</span><span class="content">I found </span><span class="delimiter">&quot;</span></span> + vowelCount + <span class="string"><span class="delimiter">&quot;</span><span class="content"> vowels in the text</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s also easier to keep track of the spaces you need. Did I remember to include the space after 'found' and the one before 'vowels'? It&#8217;s not so clear with string concatenation.</p>
</div>
<div class="paragraph">
<p>You will often see an alternative form (without the curly braces) for embedding variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">&quot;</span><span class="content">I found </span><span class="inline"><span class="inline-delimiter">$</span>vowelCount</span><span class="content"> vowels in the text</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s a little less noisy, but the expression doesn&#8217;t stand out so well. I tend to recommend to newcomers that they only use the former syntax (with curly braces) for consistency and to avoid some confusing edge cases with the latter approach. Ultimately it&#8217;s a style thing and up to you or your team.</p>
</div>
<div class="paragraph">
<p>So what happens when you want to include an actual dollar symbol in the string? Try this code snippet in the Groovy console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">&quot;</span><span class="content">I sent them a </span><span class="content">$</span><span class="content">1000 check by post</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>I see an error message:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>illegal string body character after dollar sign;
   solution: either escape a literal dollar sign "\$5" or
   bracket the value expression "${5}" at line: 1, column: 1</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s pretty clear that Groovy&#8217;s not happy about that <code>$</code> in the string. One solution is to escape it using a backslash:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">&quot;</span><span class="content">I sent them a </span><span class="char">\$</span><span class="content">1000 check by post</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It works, but isn&#8217;t pretty. Also imagine if you have a much larger string with lots of <code>$</code> symbols. What are the chances that you&#8217;re going to remember to escape all of them? In such cases, I prefer an alternative string literal using single quotes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="string"><span class="delimiter">'</span><span class="content">I sent them a $1000 check by post</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The only difference between the single-quote and double-quote versions is that the latter supports embedded expressions. It&#8217;s also important to understand that there is no memory or performance difference between the two. A double-quote string without any embedded expressions is still a plain <code>java.lang.String</code>. The decision to use one over the other then becomes one of personal preference. I prefer to use double quotes in most cases because I can easily insert an embedded expression at a later date without also changing the quotes. Others like the extra information tied to using single quotes, i.e. it is just a plain string.</p>
</div>
</div>
<div class="sect3">
<h4 id="_multi_line_strings">3.1.3. Multi-line strings</h4>
<div class="paragraph">
<p>This is the kind of thing that people have long discussions and arguments over, so let&#8217;s move swiftly on before we end up in the same boat. Imagine you want to include a block of text in your code - perhaps it&#8217;s an email template or long, formatted message you want to display to users. The easiest way to do this in Groovy is with a multi-line string literal:</p>
</div>
<div class="listingblock">
<div class="title">Listing 2.1</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">sayHello</span>(name) {
    println <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">Dear </span><span class="inline"><span class="inline-delimiter">${</span>name<span class="inline-delimiter">}</span></span><span class="content">,

Thank you for signing up to our product. We hope you enjoy!

Kind regards,

Customer Services
</span><span class="delimiter">&quot;&quot;&quot;</span></span>
}

sayHello(<span class="string"><span class="delimiter">&quot;</span><span class="content">Peter</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>So simply by using three quotes at the beginning and end, you&#8217;re allowed to put line breaks in the text. This is much nicer than using the <code>\n</code> new line character. Also notice how the above example includes an embedded expression: that&#8217;s because it uses double quotes. You can also use three single quotes (<code>'''</code>) instead, in which case the expression doesn&#8217;t get evaluated.</p>
</div>
<div class="paragraph">
<p>So far, so simple. But what if you don&#8217;t like aligning the text in the first column of the source file? Perhaps you&#8217;d prefer to indent it like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">sayHello</span>(name) {
    println <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">Dear </span><span class="inline"><span class="inline-delimiter">${</span>name<span class="inline-delimiter">}</span></span><span class="content">,

        Thank you for signing up to our product. We hope you enjoy!

        Kind regards,

        Customer Services
        </span><span class="delimiter">&quot;&quot;&quot;</span></span>
}

sayHello(<span class="string"><span class="delimiter">&quot;</span><span class="content">Peter</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unfortunately, the spaces at the beginning of each line will end up in the output because they are part of the text. All is not lost, though! The Groovy JDK provides some extra methods that are ideal for such scenarios: <code>stripIndent()</code> and <code>stripMargin()</code>.</p>
</div>
<div class="paragraph">
<p>The first of these remove any leading whitespace that is common to all lines. The second, <code>stripMargin()</code>, removes all leading characters up to a specific character (<code>|</code> by default). We&#8217;re going to use <code>stripIndent()</code> here, but there is one thing we need to be wary of: every line has to have the leading whitespace for it to be removed. And the code as it stands doesn&#8217;t have leading whitespace for the first line!</p>
</div>
<div class="paragraph">
<p>To solve that, we&#8217;re going to use a <em>line continuation</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">sayHello</span>(name) {
    println <span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">\ </span><span class="content">                   <b class="conum">(1)</b>
        Dear </span><span class="inline"><span class="inline-delimiter">${</span>name<span class="inline-delimiter">}</span></span><span class="content">,               <b class="conum">(2)</b>

        Thank you for signing up to our product. We hope you enjoy!

        Kind regards,

        Customer Services
        </span><span class="delimiter">&quot;&quot;&quot;</span></span>.stripIndent()           <b class="conum">(3)</b>
}

sayHello(<span class="string"><span class="delimiter">&quot;</span><span class="content">Peter</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><code>\</code> followed by a new line cancels the line break</p>
</li>
<li>
<p>The first line of text now has leading whitespace</p>
</li>
<li>
<p>Removes the leading whitespace from each line</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>I almost always use a line continuation for the first line of multi-line strings, just to ensure nice alignment. The main issue that typically arises from this technique is the presence of spaces or tabs after the backslash. For line continuations to work, the backslash <em>must</em> be the last character of that source code line.</p>
</div>
</div>
<div class="sect3">
<h4 id="_characters_and_type_coercion">3.1.4. Characters and type coercion</h4>
<div class="paragraph">
<p>As you&#8217;ve seen, Groovy treats strings as if they are sequences of single-character strings. This seems a little strange as the Java class library does have a specific type representing a single character: <a href="https://docs.oracle.com/javase/8/docs/api/?java/lang/Character.html"><code>java.lang.Character</code></a>. Does this mean that you shouldn&#8217;t use <code>Character</code> from Groovy?</p>
</div>
<div class="paragraph">
<p>The simple fact is that it would be hard not to use <code>Character</code> when so many Java APIs that you might want to use rely on them. For example, if you want to check whether a character is an alphabetic letter, you can use the static <code>Character.isLetter()</code> method. It takes a <code>Character</code> as its argument. To understand the problem better, consider this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> text = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>
<span class="keyword">if</span> (<span class="predefined-type">Character</span>.isUpperCase(text[<span class="integer">0</span>])) {
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">The text starts with a capital letter!</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running this results in another one of those pesky missing-something exceptions:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groovy.lang.MissingMethodException: No signature of method: static java.lang.Character.isUpperCase() is applicable for argument types: (java.lang.String) values: [J]
Possible solutions: isUpperCase(), isUpperCase(char), isUpperCase(int), toUpperCase(), toUpperCase(char), toUpperCase(int)
    at ConsoleScript27.run(ConsoleScript27:2)</pre>
</div>
</div>
<div class="paragraph">
<p>As the exception says, there is no <code>isUpperCase()</code> method that takes a string. So how do you get a <code>Character</code> in Groovy? The solution lies in a multi-purpose conversion mechanism.</p>
</div>
<div class="paragraph">
<p>Groovy provides two conversion options, one implicit and the other explicit. The implicit version consists of assigning a value of one type to a local variable declared as another type. Applying this to the previous example, we get</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> text = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>
<span class="predefined-type">Character</span> ch = text[<span class="integer">0</span>]                         <b class="conum">(1)</b>
<span class="keyword">if</span> (<span class="predefined-type">Character</span>.isUpperCase(ch)) {
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">The text starts with a capital letter!</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Explicitly declare the local variable as the required type</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This approach also works for variables declared in <code>for</code> loops:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> text = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>

<span class="keyword">def</span> upperCount = <span class="integer">0</span>
<span class="keyword">for</span> (<span class="predefined-type">Character</span> ch <span class="keyword">in</span> text) {                           <b class="conum">(1)</b>
    <span class="keyword">if</span> (<span class="predefined-type">Character</span>.isUpperCase(ch)) {
        upperCount++
    }
}

println <span class="string"><span class="delimiter">&quot;</span><span class="content">There are </span><span class="inline"><span class="inline-delimiter">${</span>upperCount<span class="inline-delimiter">}</span></span><span class="content"> upper case letters</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Explicitly declare the type of the loop variable</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The second, explicit, approach involves a new operator: <code>as</code>. This is particularly useful when introducing a new variable just adds noise to the code. The previous example where we introduced a new local variable would be better coded as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> text = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>
<span class="keyword">if</span> (<span class="predefined-type">Character</span>.isUpperCase(text[<span class="integer">0</span>] <span class="keyword">as</span> <span class="predefined-type">Character</span>)) {          <b class="conum">(1)</b>
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">The text starts with a capital letter!</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use <code>as</code> to coerce a value to a different type</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Whichever approach you use, just be aware that it doesn&#8217;t just magically convert all types to all other types. The built-in support has limited knowledge and is mostly used for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Converting a single-character string to a <code>Character</code></p>
</li>
<li>
<p>Upgrading numbers, for example from <code>Integer</code> to <code>Long</code></p>
</li>
<li>
<p>Converting a list to an array (I&#8217;ll talk about this a little later)</p>
</li>
<li>
<p>Creating a set from a list</p>
</li>
<li>
<p>Converting pretty much anything to a <code>String</code>, since every type has a <code>toString()</code> method</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can&#8217;t, for example, assign a string with more than one character in it to a <code>Character</code> variable. You&#8217;ll get a <code>GroovyCastException</code>. That&#8217;s good because automatic coercions are very useful but can cause productivity-sapping surprises when too prevalent. And remember that coercion does not happen automatically for method arguments, even if they are explicitly typed.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Object vs primitive types</div>
<div class="paragraph">
<p>Groovy inherits Java&#8217;s type system, which means that you get both primitive and object types. For example, <code>char</code> and <code>Character</code>. These two types are interchangeable in Groovy as you can call methods on primitive types. The main difference is that object types can have a <code>null</code> value.</p>
</div>
<div class="paragraph">
<p>I tend to prefer the primitive types because they are shorter and I rarely want to allow <code>null</code> values for them. The available primitive types (and corresponding object types) are:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Primitive type</th>
<th class="tableblock halign-left valign-top">Object type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Character</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Byte</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>short</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Short</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Integer</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Long</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Float</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Double</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>From this point on, I&#8217;ll use primitive types unless an object type is required for some reason.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Strings aren&#8217;t the only form of sequences. What if you want a shopping list or a simple sequence of numbers? A list is a more generic form of sequence available in Groovy and we look at that next alongside other types of collection.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_collections_ranges_and_maps">3.2. Collections, ranges and maps</h3>
<div class="paragraph">
<p>When programming, we often need to deal with collections of objects, not just single instances. That&#8217;s why most languages have built-in support for lists (an ordered collection or sequence) and other types of collection. As with strings, it&#8217;s the Java class library that provides these types in Groovy. That doesn&#8217;t mean that you get the same experience as if you&#8217;re developing in Java. In fact, Groovy brings a greater level of consistency and expressiveness.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll start with ordered collections, which are represented by the <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/List.html"><code>java.util.List</code></a> interface. In the following example, I create a list of words (strings) and then proceed to iterate over them to calculate the shortest, longest and average word lengths. Before you critize the implementation (there are better ways to do this), remember that I&#8217;m trying to introduce new concepts and APIs gradually!</p>
</div>
<div id="wordStats" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="directive">final</span> words = [<span class="string"><span class="delimiter">&quot;</span><span class="content">orange</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sit</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">flabbergasted</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">honorific</span><span class="delimiter">&quot;</span></span>]   <b class="conum">(1)</b>

<span class="keyword">def</span> minWordLength = <span class="predefined-type">Integer</span>.MAX_VALUE                                   <b class="conum">(2)</b>
<span class="keyword">def</span> maxWordLength = <span class="integer">0</span>
<span class="keyword">def</span> totalLength = <span class="integer">0</span>
<span class="keyword">for</span> (w <span class="keyword">in</span> words) {
    minWordLength = <span class="predefined-type">Math</span>.min(minWordLength, w.size())
    maxWordLength = <span class="predefined-type">Math</span>.max(maxWordLength, w.size())
    totalLength += w.size()
}

println <span class="string"><span class="delimiter">&quot;</span><span class="content">Min word length:  </span><span class="inline"><span class="inline-delimiter">${</span>minWordLength<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Max word length:  </span><span class="inline"><span class="inline-delimiter">${</span>maxWordLength<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Avg word length:  </span><span class="inline"><span class="inline-delimiter">${</span>totalLength / words.size()<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>               <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>A list literal containing strings</p>
</li>
<li>
<p><code>MAX_VALUE</code> is a static field on <code>java.lang.Integer</code></p>
</li>
<li>
<p><code>size()</code> gives the lengths of strings <em>and</em> lists</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The first thing that will strike you if you come from Java is how easy it is to create a literal list of values. It&#8217;s simply a list of comma-separated values bounded by square brackets. We can put numbers in there, dates, or any other type. We&#8217;re not even forced to use the same type for each element, so we can create a list of mixed strings and numbers for example. That said, collections commonly contain objects of the same type.</p>
</div>
<div class="paragraph">
<p>The <code>for</code> loop also works exactly the same as for strings. If you&#8217;re trying the example out in an IDE, you might even notice that it&#8217;s not worried about the <code>w.size()</code> method (IDEs with Groovy support tend to underline methods that they can&#8217;t be sure exist on a particular object, typically because they can&#8217;t be sure what the type of that object is). That&#8217;s because Groovy infers that the list only contains strings, so therefore <code>w</code> must be a string too! This is just a taster of how Groovy straddles the usual line between dynamic and static (type-checked) languages. We&#8217;ll be delving deeper into that topic later on in chapter TODO.</p>
</div>
<div class="paragraph">
<p>The previous example shows you how to iterate over a list, but what if you want to access an element at a specific index? As with strings, you can use the array index operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> words = [<span class="string"><span class="delimiter">&quot;</span><span class="content">orange</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sit</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">flabbergasted</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">honorific</span><span class="delimiter">&quot;</span></span>]

<span class="keyword">assert</span> words[<span class="integer">0</span>] == <span class="string"><span class="delimiter">&quot;</span><span class="content">orange</span><span class="delimiter">&quot;</span></span>
<span class="keyword">assert</span> words[-<span class="integer">1</span>] == <span class="string"><span class="delimiter">&quot;</span><span class="content">honorific</span><span class="delimiter">&quot;</span></span>
<span class="keyword">assert</span> words[words.size() - <span class="integer">1</span>] == <span class="string"><span class="delimiter">&quot;</span><span class="content">honorific</span><span class="delimiter">&quot;</span></span>                         <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The array index can be an expression, as long as it evaluates to an integer</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>At this point, I can almost hear some Java developers drawing breath to point out a flaw in this example. Surely I should be using the <code>equals()</code> method when comparing strings? Fortunately that&#8217;s not the case with Groovy. The <code>==</code> operator performs a value comparison rather than an object identity one. In other words, it does what any non-developer would expect it to do.</p>
</div>
<div class="paragraph">
<p>Sometimes a list literal isn&#8217;t sufficient and you need to build one dynamically. Consider a method that creates a list of the powers of two, i.e. <em>f(x) = 2<sup>x</sup></em>:</p>
</div>
<div id="powersOfTwo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">List</span> powersOfTwo(<span class="type">int</span> n) {
    <span class="keyword">def</span> result = <span class="type">[]</span>
    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="integer">0</span>..n) {                             <b class="conum">(1)</b>
        result &lt;&lt; <span class="integer">2</span> ** i                          <b class="conum">(2)</b>
    }

    <span class="keyword">return</span> result
}

<span class="keyword">assert</span> powersOfTwo(<span class="integer">2</span>) == [<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">4</span>]
<span class="keyword">assert</span> powersOfTwo(<span class="integer">8</span>) == [<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">4</span>, <span class="integer">8</span>, <span class="integer">16</span>, <span class="integer">32</span>, <span class="integer">64</span>, <span class="integer">128</span>, <span class="integer">256</span>]
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Done!</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Iterate over squential integers using a range</p>
</li>
<li>
<p>Append a new value to the list</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In this example, we start with an empty list and then add the relevant numbers to it via the <code>&lt;&lt;</code> (left shift) operator. Note that we&#8217;re modifying the list directly rather than creating a new list with the extra element. If you&#8217;d prefer to use a non-mutating approach, you can use <code>+</code> instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
    for (i <span class="keyword">in</span> <span class="integer">0</span>..n) {
        result += <span class="integer">2</span> ** i                          <b class="conum">(1)</b>
    }
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Shorthand for <code>result = result + (2 ** i)</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Yes, this approach has a cost in terms of execution speed and memory usage (you&#8217;re creating a new list and copying the existing elements on each iteration), but in many cases it&#8217;s not significant within its context.</p>
</div>
<div class="paragraph">
<p>The <code>+</code> operator can also be used to merge lists, similar to the way it&#8217;s used to concatenate strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> l1 = [<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>]
<span class="keyword">def</span> l2 = [<span class="integer">4</span>, <span class="integer">5</span>, <span class="integer">6</span>]

<span class="keyword">assert</span> l1 + l2 == [<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">4</span>, <span class="integer">5</span>, <span class="integer">6</span>]
<span class="keyword">assert</span> l1  == [<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>]
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Done!</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The more memory-efficient, mutating approach requires an explicit method call rather than an operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> l1 = [<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>]
l1.addAll([<span class="integer">4</span>, <span class="integer">5</span>, <span class="integer">6</span>])

<span class="keyword">assert</span> l1 == [<span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span>, <span class="integer">4</span>, <span class="integer">5</span>, <span class="integer">6</span>]
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Done!</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>I have noticed that some people try to use the <code>&lt;&lt;</code> operator for this, but it doesn&#8217;t work. What you end up with is a 4 element list whose last element is also a list: <code>[1, 2, 3, [4, 5, 6]]</code>. Try it!</p>
</div>
<div class="paragraph">
<p>You can find the <code>addAll()</code> method and others defined on <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/List.html"><code>java.util.List</code></a>. It&#8217;s also worth checking the <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/Collection.html"><code>java.util.Collection</code></a> and <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/Iterable.html"><code>java.util.Iterable</code></a> interfaces too, since <code>List</code> inherits from them.</p>
</div>
<div class="paragraph">
<p>When it comes to sequences, you should always try to use lists where possible as they have the richest API and widest support. They also enable you to take advantage of the Java 8 stream support. Unfortunately, you may still come across APIs that use another type of sequence: arrays.</p>
</div>
<div class="sect3">
<h4 id="_coping_with_arrays">3.2.1. Coping with arrays</h4>
<div class="paragraph">
<p>Many years ago, before Java reached version 1.2, the only built-in support for sequences (other than strings) was the array. Some people still use them for reasons of efficiency, although thats not a common case. The main reason you&#8217;ll encounter them is through using some API, often in the Java class library.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the <a href="https://docs.oracle.com/javase/8/docs/api/?java/lang/String.html"><code>String.split()</code></a> method. I frequently use this to convert a string into a sequence of words, but as you can see from the documentation, it returns an array rather than a list. So what magic do you need in order to process the array? As you can see from the following example, in some cases you don&#8217;t need to do anything:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> words = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>.split(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>)        <b class="conum">(1)</b>

<span class="keyword">def</span> minWordLength = <span class="predefined-type">Integer</span>.MAX_VALUE
<span class="keyword">def</span> maxWordLength = <span class="integer">0</span>
<span class="keyword">def</span> totalLength = <span class="integer">0</span>
<span class="keyword">for</span> (w <span class="keyword">in</span> words) {
    minWordLength = <span class="predefined-type">Math</span>.min(minWordLength, w.size())
    maxWordLength = <span class="predefined-type">Math</span>.max(maxWordLength, w.size())
    totalLength += w.size()
}

println <span class="string"><span class="delimiter">&quot;</span><span class="content">Min word length:  </span><span class="inline"><span class="inline-delimiter">${</span>minWordLength<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Max word length:  </span><span class="inline"><span class="inline-delimiter">${</span>maxWordLength<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Avg word length:  </span><span class="inline"><span class="inline-delimiter">${</span>totalLength / words.size()<span class="inline-delimiter">}</span></span><span class="content">        </span></span> <b class="conum">(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Returns a String array</p>
</li>
<li>
<p><code>size()</code> method works on arrays</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This code looks no different to the example earlier where we started with a literal list of words. Groovy allows you to treat an array as if it were a list. So you can iterate over it and also use the <code>size()</code> method. Many other Groovy JDK methods work on both lists and arrays too. Yet there are limits to this approach that you will become familiar with.</p>
</div>
<div class="paragraph">
<p>For example, you cannot append to an array. The following will result in a <code>MissingMethodException</code> for <code>leftShift()</code>, a clear sign that the method only applies to lists, not arrays:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> words = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>.split(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>)
words &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Test</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>That exception is particularly interesting because it hints at how operators such as <code>&lt;&lt;</code> are handled in Groovy. Don&#8217;t worry, I&#8217;ll be coming back to that a little later.</p>
</div>
<div class="paragraph">
<p>In fact, the uniformity that Groovy provides across arrays and lists all happens within the Groovy JDK. Arrays in Java have no methods for you to invoke and they only have one significant field: <code>length</code>. So the best place to look to find out whether you can use a particular method on an array is the Groovy JDK doc for <a href="http://docs.groovy-lang.org/docs/next/html/groovy-jdk/?java/lang/Object" class="bare">http://docs.groovy-lang.org/docs/next/html/groovy-jdk/?java/lang/Object</a>.html[<code>Object[]</code>].</p>
</div>
<div class="paragraph">
<p>Alternatively, you can banish any doubt or confusion by converting the array to a list as soon as possible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> words = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>.split(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>) <span class="keyword">as</span> <span class="predefined-type">List</span>    <b class="conum">(1)</b>
words &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Test</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use <code>as</code> to convert an array to a list</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>That <code>as</code> operator is already proving remarkably useful and will continue to do so. And I think this is the safest approach when dealing with arrays that are returned to you. Even if the API suddenly changes and returns a list, your code will continue to work (the <code>as</code> operator will just return the value as is).</p>
</div>
<div class="paragraph">
<p>I&#8217;ve covered the case of a method returning an array, but there is still the question of how to handle methods that require an array as an argument. The solution is simple and relies on a technique I&#8217;ve alread shown you. Do you remember how we got a <code>Character</code> from a <code>String</code>? You can either declare a local variable with the required type or use the <code>as</code> operator. Here&#8217;s an example using <code>as</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> proc = <span class="predefined-type">Runtime</span>.getRuntime().exec([<span class="string"><span class="delimiter">&quot;</span><span class="content">java</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">-version</span><span class="delimiter">&quot;</span></span>] <span class="keyword">as</span> <span class="predefined-type">String</span><span class="type">[]</span>)
<span class="keyword">def</span> out = <span class="keyword">new</span> <span class="predefined-type">StringWriter</span>()
<span class="keyword">def</span> err = <span class="keyword">new</span> <span class="predefined-type">StringWriter</span>()
proc.waitForProcessOutput(out, err)

println err</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you&#8217;ve probably worked out, the array type is the one with the <code>[]</code> suffix. So you can have <code>int[]</code>, <code>Object[]</code>, and so on. One thing you can&#8217;t do is initialize an array using the Java syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">String</span><span class="type">[]</span> words = <span class="keyword">new</span> <span class="predefined-type">String</span><span class="type">[]</span> { <span class="string"><span class="delimiter">&quot;</span><span class="content">orange</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sit</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">flabbergasted</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">honorific</span><span class="delimiter">&quot;</span></span> }
println words</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;ll get a compilation error if you try. In fact, this is one of the rare cases where standard Java syntax is not valid Groovy.</p>
</div>
<div class="paragraph">
<p>That&#8217;s pretty much all you really need to know about arrays. I&#8217;d like to finish here with just a brief look at the <code>MissingMethodException</code> I mentioned earlier. The full message looks like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groovy.lang.MissingMethodException: No signature of method: [Ljava.lang.String;.leftShift()
is applicable for argument types: (java.lang.String) values: [Test]
        at ConsoleScript9.run(ConsoleScript9:2)</pre>
</div>
</div>
<div class="paragraph">
<p>Look carefully at the method signature. What type does it think <code>leftShift()</code> is being invoked on? Yes, it&#8217;s <code>[Ljava.lang.String;</code>. That looks a bit weird, right? This is the stringified form of the associated array class. You can easily identify arrays by that leading <code>[</code>. The <code>L</code> and trailing <code>;</code> represent an object type. Here are some more examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>int[]      =&gt;  [I
Integer[]  =&gt;  [Ljava.lang.Integer;</pre>
</div>
</div>
<div class="paragraph">
<p>I bring this up because it&#8217;s important to recognise what types are involved when you&#8217;re trying to diagnose problems in your code, and Java doesn&#8217;t make it too easy when it comes to arrays!</p>
</div>
<div class="paragraph">
<p>Although sequences are common, they aren&#8217;t the only form of data structure. Sometimes you don&#8217;t care about order but do want to ensure that you don&#8217;t have duplicate elements. That&#8217;s when a set comes in handy. Or you may want a list that is cheap to add elements to. It&#8217;s useful to know how to work with other collection types.</p>
</div>
</div>
<div class="sect3">
<h4 id="_collection_types">3.2.2. Collection types</h4>
<div class="paragraph">
<p>I&#8217;ve already mentioned that lists in Groovy implement <code>java.util.List</code>. That&#8217;s an interface, so what type of list are you actually getting when you use the list literal? It&#8217;s easy to find out in the Groovy console using the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println(<span class="type">[]</span>.getClass())</code></pre>
</div>
</div>
<div class="paragraph">
<p>Hopefully you&#8217;ll see <code>class java.util.ArrayList</code> in the output pane. This is possibly the most commonly used list implementation in Java as it&#8217;s cheap to access elements at an arbitrary index (otherwise known as random access). You can find out more about its characteristics in the <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/ArrayList.html">Java API docs</a>.</p>
</div>
<div class="paragraph">
<p>Before I talk about other list implementations, I&#8217;d like to point out a common gotcha with the previous example. In its case, the parentheses for <code>println()</code> are required. Otherwise you get a <code>MissingPropertyException</code> for <code>println</code>. Why? Because Groovy interprets the square brackets in this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println <span class="type">[]</span>.getClass()</code></pre>
</div>
</div>
<div class="paragraph">
<p>as the array index operator, not a list literal. As in <code>people[0].getClass()</code>. If you get into this kind of situation, make sure you fully digest the exception message. It often reveals the source of the problem right away. In this case, the exception makes it clear that Groovy thinks that <code>println</code> is a property, not a method. The quick insertion of parentheses will quickly resolve such cases.</p>
</div>
<div class="paragraph">
<p>Back to list types. Given that there are different implementations, the key question is this: how do you use an alternative implementation to <code>java.util.ArrayList</code>? The answer depends on whether you&#8217;re starting with an existing list or not. Let&#8217;s go back to our list of words, but this time make it a <em>linked list</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> words = [<span class="string"><span class="delimiter">&quot;</span><span class="content">orange</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sit</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">flabbergasted</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">honorific</span><span class="delimiter">&quot;</span></span>] <span class="keyword">as</span> <span class="predefined-type">LinkedList</span>

println words.getClass()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once again, it&#8217;s the <code>as</code> operator that comes to our rescue. You can of course explicitly declare a local variable as type <code>LinkedList</code> for the same effect.</p>
</div>
<div class="paragraph">
<p>Array lists and linked lists are the two main types of list provided by the core Java class library. You might notice a couple of other implementations lurking in the <code>java.util</code> package too: <code>Vector</code> and <code>Stack</code>. They&#8217;re pretty much legacy, superseded by <code>ArrayList</code> and queues, and you can safely ignore them. If you have specialist requirements, consider third-party libraries, such as <a href="https://github.com/google/guava">Google&#8217;s Guava</a>, that provide alternative list implementations.</p>
</div>
<div class="paragraph">
<p>Java does provided greater variety when it comes to <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/Queue.html"><code>java.util.Queue</code></a> and <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/Deque.html"><code>java.util.Deque</code></a> (double-ended queues) implementations, although Groovy defaults to <code>LinkedList</code> if you coerce a list to <code>Queue</code>. A more distinct collection type is the set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> uniqueNumbers = [<span class="integer">3</span>, <span class="integer">3</span>, <span class="integer">1</span>, <span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">2</span>] <span class="keyword">as</span> <span class="predefined-type">Set</span>

<span class="keyword">assert</span> uniqueNumbers.size() == <span class="integer">3</span>
println uniqueNumbers
println uniqueNumbers.getClass()</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, a <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/Set.html">java.util.Set</a> doesn&#8217;t allow duplicate elements. They typically don&#8217;t care about order either. However, Groovy&#8217;s default implementation (<code>java.util.LinkedHashSet</code>) will reliably print the numbers in the same order as they are declared in the list literal. That&#8217;s because it retains <em>insertion order</em>, so when you iterate over the set, it does it in the order that elements were added to the collection.</p>
</div>
<div class="paragraph">
<p>A more common requirement, especially for numbers and strings, is to use the elements' <em>natural sort order</em>. You can easily create such a set by coercing to the <code>java.util.SortedSet</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> uniqueNumbers = [<span class="integer">3</span>, <span class="integer">3</span>, <span class="integer">1</span>, <span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">2</span>] <span class="keyword">as</span> <span class="predefined-type">SortedSet</span>

println uniqueNumbers
println uniqueNumbers.getClass()</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will now see the set printed out as <code>[1, 2, 3]</code> with a class of <code>java.util.TreeSet</code>.</p>
</div>
<div class="paragraph">
<p>This isn&#8217;t the only way to get the collection type you want, particularly if you want to start with an empty one. Since the collections are normal Java classes, you can instantiate them directly using the <code>new</code> keyword:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> uniqueNumbers = <span class="keyword">new</span> <span class="predefined-type">HashSet</span>()
uniqueNumbers.addAll([<span class="integer">1</span>, <span class="integer">1</span>, <span class="integer">2</span>, -<span class="integer">1</span>, <span class="integer">1</span>])

println uniqueNumbers</code></pre>
</div>
</div>
<div class="paragraph">
<p>Interestingly, when I run this script I see the numbers printed in numeric order: -1, 1, 2. Trust me, that&#8217;s a coincidence. The <code>HashSet</code> implementation gives no guarantees as to its iteration order.</p>
</div>
<div class="paragraph">
<p>There&#8217;s just one more type connected with collections that I want to cover: the map, also known as an associative array.</p>
</div>
</div>
<div class="sect3">
<h4 id="_maps">3.2.3. Maps</h4>
<div class="paragraph">
<p>I remember my early C++ days when it was hard to find an existing hash map implementation. I even remember trying to write my own. So it was with some relief that I saw Java came with its own map classes, which I could use with abandon. I haven&#8217;t looked back.</p>
</div>
<div class="paragraph">
<p>Perhaps surprisingly, the <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/Map"><code>java.util.Map</code></a> interface doesn&#8217;t extend <code>java.util.Collection</code>, even though you can think of it as a collection of key-value pairs. For example, consider this script which prints the keys and value of all the entries in a map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> epics = [<span class="key">VMW</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">VMware</span><span class="delimiter">&quot;</span></span>, <span class="key">MSFT</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Microsoft</span><span class="delimiter">&quot;</span></span>, <span class="key">AAPL</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Apple</span><span class="delimiter">&quot;</span></span>]

<span class="keyword">for</span> (e <span class="keyword">in</span> epics) {
    println <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>e.key<span class="inline-delimiter">}</span></span><span class="content">: </span><span class="inline"><span class="inline-delimiter">${</span>e.value<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A map literal looks a lot like a list literal, with the square brackets and comma-separated elements. The key difference is that you have a colon between each key and its value. When you then iterate over a map, each element is an instance of <a href="https://docs.oracle.com/javase/8/docs/api/?java/util/Map.Entry.html"><code>java.util.Map.Entry</code></a>. Note that <code>Entry</code> is defined within the <code>Map</code> interface, making it a nested interface.</p>
</div>
<div class="paragraph">
<p>A closer look at the <code>Entry</code> class shows that there are no <code>key</code> or <code>value</code> fields there, so why does <code>e.key</code> work? The answer lies in Groovy&#8217;s concept of properties. Don&#8217;t worry, I&#8217;ll explain these as soon as I&#8217;ve finished with maps.</p>
</div>
<div class="paragraph">
<p>Iterating over a map is all very well, but one of the main reasons to use such a data structure is so that you can quickly look up the value for a given key. Groovy allows you to do this through the array index operator, using a key instead of an integer. You use the same operator to add or overwrite individual entries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> epics = [<span class="key">VMW</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">VMware</span><span class="delimiter">&quot;</span></span>, <span class="key">MSFT</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Microsoft</span><span class="delimiter">&quot;</span></span>, <span class="key">AAPL</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Apple</span><span class="delimiter">&quot;</span></span>]
<span class="keyword">def</span> searchKey = <span class="string"><span class="delimiter">&quot;</span><span class="content">MSFT</span><span class="delimiter">&quot;</span></span>

println epics[searchKey]                                     <b class="conum">(1)</b>

epics[searchKey] = <span class="string"><span class="delimiter">&quot;</span><span class="content">Micro</span><span class="inline"><span class="inline-delimiter">$</span>oft</span><span class="delimiter">&quot;</span></span>
epics[<span class="string"><span class="delimiter">&quot;</span><span class="content">GOOG</span><span class="delimiter">&quot;</span></span>] = <span class="string"><span class="delimiter">&quot;</span><span class="content">Google</span><span class="delimiter">&quot;</span></span>                                     <b class="conum">(2)</b>

println epics</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Fetches the value for a given value (returns <code>null</code> if the key doesn&#8217;t exist)</p>
</li>
<li>
<p>Adds another map entry</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note how I need to use string literals with the array index operator but not in the map literal. That&#8217;s because the literal is a special case in which the key is assumed to be a string literal by default. The example will work just the same if you put quotes around the keys like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> epics = [<span class="string"><span class="delimiter">&quot;</span><span class="content">VMW</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">VMware</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">MSFT</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Microsoft</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">AAPL</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Apple</span><span class="delimiter">&quot;</span></span>]
println epics</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s really just a convenience because string keys are so common in map literals. Of course, not all maps use strings for their keys. What happens if you want your keys to be numbers? That&#8217;s easy because number literals (integers and floating point) work as is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> numberWords = [<span class="integer">1</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">One</span><span class="delimiter">&quot;</span></span>, <span class="integer">2</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Two</span><span class="delimiter">&quot;</span></span>, <span class="integer">3</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Three</span><span class="delimiter">&quot;</span></span>]
println numberWords[<span class="integer">2</span>]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The downside comes when you want to use a variable (or more specifically its value) as a key. This is a surprisingly rare scenario, but as an example, imagine we have a method that takes a string as an argument and returns a map with that string as a key and its length as the value:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">stringAttributes</span>(<span class="predefined-type">String</span> str) {
    <span class="keyword">return</span> [(str): str.size()]                               <b class="conum">(1)</b>
}

println stringAttributes(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello world!</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use the string value as the key, not the literal <code>"str"</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When you run the script you should see the output</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[Hello world!:12]</pre>
</div>
</div>
<div class="paragraph">
<p>These basics will get you through the examples in rest of the book, so I want to go back to the question of why <code>e.key</code> works when there is no field on the <code>Map.Entry</code> class with that name. It&#8217;s time to talk about one of the most important concepts in Groovy: properties.</p>
</div>
</div>
<div class="sect3">
<h4 id="_properties">3.2.4. Properties</h4>
<div class="paragraph">
<p>In object-oriented languages, objects can have both state and behavior. That means fields and methods if you&#8217;re writing Java. The trouble with fields is that you can&#8217;t override them, for example to evaluate their values on demand. So Groovy introduces an additional form of state: the property. The basic idea is that properties are accessed through two methods whose signatures follow a specific convention:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;property type&gt; get&lt;PropertyName&gt;()
void set&lt;PropertyName&gt;(&lt;property type&gt; val)</pre>
</div>
</div>
<div class="paragraph">
<p>These are known as the <em>getter</em> and <em>setter</em> methods, or simply getters and setters. So in the case of the <code>Map.Entry</code> class, you have a <code>getKey()</code> method that corresponds to a property named <code>key</code>, and <code>getValue()</code> and <code>setValue()</code> methods that represent a <code>value</code> property.</p>
</div>
<div class="paragraph">
<p>So how do you map the method names to the equivalent property names? The rules are based on the <a href="http://www.oracle.com/technetwork/java/javase/documentation/spec-136004.html">JavaBeans specification</a>, but it&#8217;s probably easiest to understand through some examples. Here&#8217;s a table mapping method names to property names:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Property name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getKey()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>key</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getFullName()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>fullName</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getLine1Address()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>line1Address</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isHidden()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>hidden</code> (only valid for boolean properties)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getURLScheme()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>URLScheme</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As you can see, the basic rule is to remove the leading "get" and then lower case the first letter of what&#8217;s left. The only case in which this rule doesn&#8217;t hold is when the first two letters of what&#8217;s left are both upper case. The property name is the samme as the method name in this situation (minus the "get"). It&#8217;s also worth pointing out that boolean properties can use a getter or an <code>is&lt;PropertyName&gt;()</code> method.</p>
</div>
<div class="paragraph">
<p>The <code>Map.Entry</code> example raises another question. What happens when there is a getter but no setter, as is the case with <code>Entry.getKey()</code>? To demonstrate, I&#8217;m going to bring in the <code>File</code> class and try to change the name of the file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> f = <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test.txt</span><span class="delimiter">&quot;</span></span>)
println f.name

f.name = <span class="string"><span class="delimiter">&quot;</span><span class="content">new.txt</span><span class="delimiter">&quot;</span></span>
println f.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running this will print out "test.txt" as expected, but you&#8217;ll see an exception following on swiftly:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>groovy.lang.ReadOnlyPropertyException: Cannot set readonly property: name for class: java.io.File
        at ConsoleScript9.run(ConsoleScript9:4)</pre>
</div>
</div>
<div class="paragraph">
<p>So if you have a getter without a corresponding setter, you end up with a read-only property. This can be particularly useful for properties that are calculated on demand and have no corresponding field to store the state.</p>
</div>
<div class="paragraph">
<p>You can of course still access the methods as methods. You don&#8217;t have to use property syntax. The above example then becomes</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> f = <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">test.txt</span><span class="delimiter">&quot;</span></span>)
println f.getName()

f.setName(<span class="string"><span class="delimiter">&quot;</span><span class="content">new.txt</span><span class="delimiter">&quot;</span></span>)
println f.getName()</code></pre>
</div>
</div>
<div class="paragraph">
<p>This time, though, you&#8217;ll get a <code>MissingMethodException</code>. Otherwise the script behaves as before.</p>
</div>
<div class="paragraph">
<p>I generally prefer property syntax over using the methods directly because the code looks cleaner and more readable, which I find very valuable. One of the few time I prefer using a getter method explicitly is with the ubiquitous <code>getClass()</code>, which tells you the type of an object. The reason for that is because of what happens when you use property syntax on a map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> map = [:]                                                <b class="conum">(1)</b>
println map.class
println map.getClass()</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This is an empty map. The colon distinguishes it from an empty list.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You&#8217;ll see that the script first prints <code>null</code> before then displaying the full type of the map on the next line. That&#8217;s because Groovy adds special behavior to <code>Map</code> that overrides the default property access. So the second line of the script looks for a key named "class", doesn&#8217;t find it, and returns <code>null</code>. I&#8217;ve been caught out by this more times than I can recount, so I just use <code>getClass()</code> explicitly.</p>
</div>
<div class="paragraph">
<p>Speaking of property syntax and maps, let&#8217;s take a look at a previous map example, replacing the array index operator with property access:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> epics = [<span class="key">VMW</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">VMware</span><span class="delimiter">&quot;</span></span>, <span class="key">MSFT</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Microsoft</span><span class="delimiter">&quot;</span></span>, <span class="key">AAPL</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Apple</span><span class="delimiter">&quot;</span></span>]
println epics.MSFT

epics.GOOG = <span class="string"><span class="delimiter">&quot;</span><span class="content">Google</span><span class="delimiter">&quot;</span></span>
println epics</code></pre>
</div>
</div>
<div class="paragraph">
<p>Whether you use the array index operator or property syntax depends on your own preferences. I typically use the former if I know that I&#8217;m dealing with a map. However, property syntax can be useful if the target object could be a map or another type entirely. I&#8217;ll explain how this works when I dive into the dynamic nature of standard Groovy. Other developers prefer the property syntax because it&#8217;s less noisy and easier to type (my little finger certainly struggles with the square brackets on a US keyboard).</p>
</div>
<div class="paragraph">
<p>You&#8217;ve now been introduced to the core types in Groovy, which will set you in good stead for future examples. It&#8217;s hard to code without strings, collections, or maps! I just want to finish off this chapter with a more complete example that you can play with, based on Pig Latin.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_chapter_example">3.3. Chapter example</h3>
<div class="paragraph">
<p>If you&#8217;re not familiar with Pig Latin, it&#8217;s a technique for obfuscating English words so that they aren&#8217;t instantly recognisable. The rules I&#8217;ll follow are fairly straightforward:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a word begins with a consonant, I move the starting consonants to the end of the word and then add an "ay" suffix.</p>
<div class="literalblock">
<div class="content">
<pre>For example, "happy" becomes _appyhay_ and "glove" becomes _oveglay_.</pre>
</div>
</div>
</li>
<li>
<p>If a word begins with a vowel or a silent letter, then I simply add "way" as a suffix.</p>
<div class="literalblock">
<div class="content">
<pre>For example, "egg" becomes _eggway_ and "eight" becomes _eightway_.</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find out more information about Pig Latin <a href="http://en.wikipedia.org/wiki/Pig_Latin">on Wikipedia</a>. It&#8217;s mostly just a game that people play. So how do we go about implementing such a thing?</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with a script that has a method for doing the conversion plus a bunch of assertions to verify that it works correctly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">String</span> pigLatinize(<span class="predefined-type">String</span> text) {
    <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
}

<span class="keyword">assert</span> pigLatinize(<span class="string"><span class="delimiter">&quot;</span><span class="content">happy</span><span class="delimiter">&quot;</span></span>) == <span class="string"><span class="delimiter">&quot;</span><span class="content">appyhay</span><span class="delimiter">&quot;</span></span>
<span class="keyword">assert</span> pigLatinize(<span class="string"><span class="delimiter">&quot;</span><span class="content">egg</span><span class="delimiter">&quot;</span></span>) == <span class="string"><span class="delimiter">&quot;</span><span class="content">eggway</span><span class="delimiter">&quot;</span></span>
<span class="keyword">assert</span> pigLatinize(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello earth</span><span class="delimiter">&quot;</span></span>) == <span class="string"><span class="delimiter">&quot;</span><span class="content">ellohay earthway</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As it stands, running this script will result in an assertion error. It&#8217;s kind of obvious because the method always returns an empty string. I&#8217;m just trying to take the Test Driven Development (TDD) approach!</p>
</div>
<div class="paragraph">
<p>The logic for the conversion is deceptively simple (if we ignore the hard cases):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Split the text into individual words</p>
</li>
<li>
<p>Convert each word</p>
<div class="ulist">
<ul>
<li>
<p>If the word starts with a series of consonants, place them at the end</p>
</li>
<li>
<p>Add an 'ay' suffix</p>
</li>
</ul>
</div>
</li>
<li>
<p>Recombine the words into a single string</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before we start, though, consider how we are going to do the split and merge. We ideally want to retain all the characters between words and make sure that they get merged back in at the right places. Another thing to consider is whether we want to handle hyphens or other characters that can occur in words. Dealing with strings is rarely easy.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a quick and dirty approach: split the text on word boundaries using a regular expression. That will at least retain the characters between words, ensuring that they appear in the result. We may still have trouble with some bits of text, but t will work as a simple demonstration. You can experiment with other approaches as you see fit! Here&#8217;s my suggested implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">String</span> pigLatinize(<span class="predefined-type">String</span> text) {
    <span class="keyword">def</span> wordsAndSeparators = text.split(<span class="regexp"><span class="delimiter">/</span><span class="char">\b</span><span class="delimiter">/</span></span>)                <b class="conum">(1)</b>
    <span class="keyword">def</span> pigLatinWords = <span class="type">[]</span>
    <span class="keyword">for</span> (str <span class="keyword">in</span> wordsAndSeparators) {
        <span class="keyword">if</span> (<span class="predefined-type">Character</span>.isLetter(str[<span class="integer">0</span>] <span class="keyword">as</span> <span class="type">char</span>)) {            <b class="conum">(2)</b>
            pigLatinWords &lt;&lt; pigLatinizeWord(str)
        }
        <span class="keyword">else</span> {
            pigLatinWords &lt;&lt; str
        }
    }
    <span class="keyword">return</span> pigLatinWords.join(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)                            <b class="conum">(3)</b>
}

<span class="predefined-type">String</span> pigLatinizeWord(<span class="predefined-type">String</span> word) {
    <span class="keyword">def</span> leadingConsonants = leadingConsonants(word)
    <span class="keyword">return</span> (word - leadingConsonants) + (leadingConsonants ?: <span class="string"><span class="delimiter">'</span><span class="content">w</span><span class="delimiter">'</span></span>) + <span class="string"><span class="delimiter">&quot;</span><span class="content">ay</span><span class="delimiter">&quot;</span></span>
}

<span class="predefined-type">String</span> leadingConsonants(<span class="predefined-type">String</span> word) {
    <span class="keyword">def</span> vowels = [<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">e</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">i</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">o</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">u</span><span class="delimiter">&quot;</span></span>] <span class="keyword">as</span> <span class="predefined-type">Set</span>
    <span class="keyword">def</span> firstVowelIndex = <span class="integer">0</span>
    <span class="keyword">for</span> (ch <span class="keyword">in</span> word) {
        <span class="keyword">if</span> (ch <span class="keyword">in</span> vowels) {
            <span class="keyword">break</span>                                            <b class="conum">(4)</b>
        }
        firstVowelIndex++
    }

    <span class="keyword">return</span> word.substring(<span class="integer">0</span>, firstVowelIndex)
}

<span class="keyword">assert</span> pigLatinize(<span class="string"><span class="delimiter">&quot;</span><span class="content">happy</span><span class="delimiter">&quot;</span></span>) == <span class="string"><span class="delimiter">&quot;</span><span class="content">appyhay</span><span class="delimiter">&quot;</span></span>
<span class="keyword">assert</span> pigLatinize(<span class="string"><span class="delimiter">&quot;</span><span class="content">egg</span><span class="delimiter">&quot;</span></span>) == <span class="string"><span class="delimiter">&quot;</span><span class="content">eggway</span><span class="delimiter">&quot;</span></span>
<span class="keyword">assert</span> pigLatinize(<span class="string"><span class="delimiter">&quot;</span><span class="content">hello earth</span><span class="delimiter">&quot;</span></span>) == <span class="string"><span class="delimiter">&quot;</span><span class="content">ellohay earthway</span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Done!</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Breaks text into a list of words using the JDK method <code>String.split()</code></p>
</li>
<li>
<p>Only pig latinize words that start with a letter</p>
</li>
<li>
<p>Merge the list of words into a single string</p>
</li>
<li>
<p>Break out of the loop once we hit a vowel</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Have fun with the example! The only features that I haven&#8217;t covered so far are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>break</code> can be used to prematurely stop a <code>for</code> loop.</p>
</li>
<li>
<p><code>?:</code> is a special operator which uses the value on the left hand side if it&#8217;s not <code>null</code> or an empty string. Otherwise you get the right hand side instead. It&#8217;s useful for default values: if this expression is already a valid value, use that, otherwise use this default value. It&#8217;s often referred to as the Elvis operator.</p>
</li>
<li>
<p><code>/&#8230;&#8203;/</code> is a special string delimiter like <code>'&#8230;&#8203;'</code> and <code>"&#8230;&#8203;"</code>. It&#8217;s behavior is identical to double-quoted strings except you don&#8217;t need to escape the "\" character. It&#8217;s particularly useful with regular expressions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the next chapter, I want to take the foundations set out in the first two chapters and use them to start doing some practical work with scripts, making use of other Java types and libraries.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_doing_odd_jobs_scripting">4. Doing odd jobs (scripting)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As software developers, we typically build applications and systems. And yet we often find ourselves doing miscellaneous other tasks that involve processing text files, fixing databases, generating reports, etc. Those tasks may even need to be repeated in the future. Such tasks can be laborious and error prone when performed manually, so I like to write scripts to handle them.</p>
</div>
<div class="paragraph">
<p>In the past, I&#8217;d break out Sed and Awk for text processing and Ruby/Python for anything more involved. But these are not tools that I use day to day and I&#8217;d end up spending a lot of time trying to remember their syntaxes and (in the case of Ruby &amp; Python) their class libraries. That&#8217;s not helpful when you&#8217;re trying to <em>save</em> yourself time.</p>
</div>
<div class="paragraph">
<p>Groovy&#8217;s an ideal scripting language for Java developers because it makes many of the things you need to do in scripts easy compared to Java, while using the same class library and a very similar syntax. You don&#8217;t have a big context switch going between Groovy and Java. Even if you&#8217;re an avid fan of a different scripting language, Groovy&#8217;s worth considering simply due to the JVM&#8217;s cross-platform support, which is handy in multi-platform environments.</p>
</div>
<div class="paragraph">
<p>In this chapter, I&#8217;ll show some common use cases for Groovy scripting that will also help you to become familiar with more of the standard API. I&#8217;ll also stop along the way to discuss any language structures that appear, with a particular focus on an important feature called closures.</p>
</div>
<div class="sect2">
<h3 id="_working_with_the_filesystem">4.1. Working with the filesystem</h3>
<div class="paragraph">
<p>A lot of scripting needs involve files: finding them, parsing them, creating them, moving them around, and so on. Java&#8217;s API has been traditionally weak in this area, which is why you&#8217;ll find libraries like <a href="http://commons.apache.org/proper/commons-io/">Commons IO</a> that provide a lot of extra utility and convenience. That changed with Java 8, which introduced some significant enhancements to the file APIs. Not everyone will be able to use Java 8 though, so I will give examples for both Java 6 and Java 8. Even if you&#8217;re able to use the latter, you will certainly find it useful to learn the old API because so many Groovy projects use them and will probably continue to use them.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the basic mechanism of reading and writing files. Imagine you have a comma-separated values (CSV) file containing the first and last names of authors along with the country and date of birth. Your first job is to print out all the names of the authors sorted alphabetically by their surnames (or family names). Here&#8217;s a quick script to do that using Java 8, which you can run in the Groovy console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">java.nio.charset.Charset</span>                              <b class="conum">(1)</b>
<span class="keyword">import</span> <span class="include">java.nio.file.Files</span>
<span class="keyword">import</span> <span class="include">java.nio.file.FileSystems</span>

<span class="keyword">def</span> lines = Files.readAllLines(
        FileSystems.default.getPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">authors.csv</span><span class="delimiter">&quot;</span></span>),          <b class="conum">(2)</b>
        <span class="predefined-type">Charset</span>.forName(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>))

<span class="keyword">def</span> authorNames = <span class="type">[]</span>
<span class="keyword">for</span> (l <span class="keyword">in</span> lines) {
    <span class="keyword">def</span> authorDetails = l.split(<span class="regexp"><span class="delimiter">/</span><span class="char">\s</span><span class="content">*,</span><span class="char">\s</span><span class="content">*</span><span class="delimiter">/</span></span>)
    authorNames &lt;&lt; <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>authorDetails[<span class="integer">1</span>]<span class="inline-delimiter">}</span></span><span class="content">, </span><span class="inline"><span class="inline-delimiter">${</span>authorDetails[<span class="integer">0</span>]<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
}

authorNames = authorNames.sort()
<span class="keyword">for</span> (name <span class="keyword">in</span> authorNames) {
    println name
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Most classes need importing before you can reference them</p>
</li>
<li>
<p>Create a file path representing the location of the CSV file</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There&#8217;s much to talk about here, starting with the core classes we&#8217;re using to work with the filesystem. The <code>FileSystems</code> class provides access to the default <code>FileSystem</code> of the current platform (Windows, Mac OS X, Linux, etc.), which in turn allows you to construct file paths represented by the <code>java.nio.file.Path</code> interface - a contract of behavior without an implementation. Those file paths are then used by the methods of the <code>Files</code> class to perform file operations, such as copying, reading, and listing directories. <code>Charset</code> is simply a representation of a character encoding such as ISO-8859-1 and UTF-8.</p>
</div>
<div class="paragraph">
<p>Why do we import these classes? It&#8217;s to help avoid name clashes. Classes have a name and a package, also known as a namespace in other languages. This means you can have classes with the same name as long as they are in different packages. The result is that you have to tell Groovy (and Java) which class you are referring to in your code, and that&#8217;s what the <code>import</code> statement does.</p>
</div>
<div class="paragraph">
<p>The <code>readAllLines()</code> method assumes that the target file is text with line breaks in it and produces a list of the lines of text. One interesting aspect of this particular method call is that I explicitly specify a character encoding. If you don&#8217;t provide one, the method assumes the text is encoded using the default platform encoding, which varies between Windows, Mac OS X and Linux. I like to use UTF-8 everywhere, but that may not be appropriate for you. It largely depends on who creates the files in the first place. Yes it&#8217;s a headache if you&#8217;re dealing with any non-ASCII characters, but you need to factor it in to your coding right from the start.</p>
</div>
<div class="paragraph">
<p>The rest of the script uses features I introduced in the previous chapter. It simply breaks each line of text into its component parts, removing the commas in the process. The first name and last name for each entry are then combined into a single author name string, with the last name first. That means we can perform a natural order sort on the resulting list to get the names in last name order before then printing them all.</p>
</div>
<div class="paragraph">
<p>Hopefully that&#8217;s all straightforward for you, even though the code for reading the file seems more verbose than is perhaps necessary. So what happens if you don&#8217;t have access to a Java 8 or newer JVM? In that case, you can use the old <code>java.io.File</code> class instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> lines = <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">authors.csv</span><span class="delimiter">&quot;</span></span>).readLines(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>)

<span class="keyword">def</span> authorNames = <span class="type">[]</span>
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>I&#8217;ve only shown the file reading code because that&#8217;s the only difference from the previous example. What&#8217;s striking is that I&#8217;ve somehow managed to replace 4 lines of code with just one. A big reason for this is the lack of imports, since I&#8217;m only using a single class this time, <code>File</code>, and Groovy doesn&#8217;t require you to import it. In fact, there are several core packages that don&#8217;t need to be imported because they&#8217;re so commonly used. Here&#8217;s a short list of those exceptions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.lang.*</code></p>
</li>
<li>
<p><code>java.io.*</code></p>
</li>
<li>
<p><code>java.net.*</code></p>
</li>
<li>
<p><code>java.util.*</code></p>
</li>
<li>
<p><code>java.math.BigDecimal</code></p>
</li>
<li>
<p><code>java.math.BigInteger</code></p>
</li>
<li>
<p><code>groovy.lang.*</code></p>
</li>
<li>
<p><code>groovy.util.*</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These packages cover such classes as <code>File</code>, <code>String</code>, <code>List</code>, and <code>URL</code>, which means that your scripts become a lot cleaner without those <code>import</code> statements. One thing that newcomers may find confusing is how sub-packages are treated. Consider the classes associated with regular expressions, which I&#8217;ll talk more about later in this chapter. They reside in the package <code>java.util.regex</code>, which looks like a sub-package of <code>java.util</code>. In fact, packages aren&#8217;t hierarchical except in the way we developers interpret them. The concrete result is that you have to explicitly import a class like <code>java.util.regex.Pattern</code> because its not covered by the <code>java.util.*</code> auto import.</p>
</div>
<div class="paragraph">
<p>Another factor in the reduced amount of code is that <code>File</code> is a simpler API. And that&#8217;s one reason why you will continue to see it, even with code that exclusively runs on Java 8 or above. One thing to bear in mind is that in this case, the <code>readLines()</code> method is provided by the Groovy JDK extensions rather than Java. I recommend that you peruse the <a href="http://docs.groovy-lang.org/docs/next/html/groovy-jdk/?java/io/File.html">Groovy JDK documentation</a> for <code>File</code> because you&#8217;ll find plenty of useful methods to try out.</p>
</div>
<div class="paragraph">
<p>This all raises an obvious yet important question: Which API should you use? I would argue that you should move over to the new NIO classes as soon as you can. Although <code>File</code> is generally simpler and less verbose, which is fine for scripts with simple needs, the NIO API has several advantages. First, it&#8217;s easier to unit test as <code>Path</code> is an interface and you can implement your own mock <code>FileSystem</code> (or you can use an existing one such as <a href="https://github.com/google/jimfs">JIMFS</a>). Second, it integrates with Java 8 streams, allowing you to do things like lazily walk a directory tree.</p>
</div>
<div class="paragraph">
<p>One way to reduce the clutter in the Java 8 version of the CSV script is to make use of some special <code>import</code> features. You can both alias a class, giving it a shorter name, and explicitly import static methods, meaning you don&#8217;t have to qualify them with the class name. Here&#8217;s a modified version of the script using these techniques:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">static</span> <span class="include">java.nio.file.Files.readAllLines</span>               <b class="conum">(1)</b>

<span class="keyword">import</span> <span class="include">java.nio.charset.Charset</span> <span class="keyword">as</span> <span class="class">Ch</span>                        <b class="conum">(2)</b>
<span class="keyword">import</span> <span class="include">java.nio.file.FileSystems</span> <span class="keyword">as</span> <span class="class">FS</span>

<span class="keyword">def</span> lines = readAllLines(FS.default.getPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">authors.csv</span><span class="delimiter">&quot;</span></span>), Ch.forName(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>))

<span class="keyword">def</span> authorNames = <span class="type">[]</span>
...</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Allows us to call <code>readAllLines()</code> without qualifying with the class name</p>
</li>
<li>
<p>Aliases the class name to something shorter</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>As you can see, the code for reading the lines of text from the file is now more readable, which is always good for aiding comprehension of your code. You&#8217;ll find static imports in Java as well, but the aliasing is specific to Groovy.</p>
</div>
<div class="paragraph">
<p>I now want to move away from the kinds of scripts that you can run in the Groovy console to something a bit more useful: command line scripts. You can still write them in the Groovy console, but you must first save them to a file before you can run them from the command line.</p>
</div>
<div class="paragraph">
<p>The first example harks back to the days of Apache Ant, a venerable build tool from the Java world. I often used its Filter task as a simple template engine, replacing occurrences of <code>@TOKEN@</code> with whatever parameter values I needed. It&#8217;s not hard to reproduce this behavior in a Groovy script, as you&#8217;ll see from the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">java.nio.file.FileSystems</span> <span class="keyword">as</span> <span class="class">FS</span>

<span class="keyword">if</span> (args.size() != <span class="integer">1</span>) {
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Incorrect number of arguments.</span><span class="delimiter">&quot;</span></span>
    println <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">USAGE: processTemplates TMPL_PATH</span><span class="delimiter">&quot;</span></span>
    <span class="predefined-type">System</span>.exit(<span class="integer">1</span>)
}

<span class="directive">final</span> tokens = [                                             <b class="conum">(1)</b>
    <span class="key">NAME</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Whizzbang</span><span class="delimiter">&quot;</span></span>,
    <span class="key">CURRENT_DATE</span>: <span class="keyword">new</span> <span class="predefined-type">Date</span>()]
<span class="directive">final</span> templatePath = FS.default.getPath(args[<span class="integer">0</span>])
<span class="directive">final</span> sourceText = templatePath.getText(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>)

<span class="keyword">def</span> processedText = sourceText
<span class="keyword">for</span> (entry <span class="keyword">in</span> tokens) {
    processedText = processedText.replace(                   <b class="conum">(2)</b>
            <span class="string"><span class="delimiter">&quot;</span><span class="content">@</span><span class="inline"><span class="inline-delimiter">${</span>entry.key<span class="inline-delimiter">}</span></span><span class="content">@</span><span class="delimiter">&quot;</span></span>,
            entry.value.toString())
}

<span class="directive">final</span> outFile = FS.default.getPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">processed.txt</span><span class="delimiter">&quot;</span></span>)
outFile.setText(processedText, <span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>)                      <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Hard code the replacement tokens</p>
</li>
<li>
<p>Perform the token substitution using a standard JDK method</p>
</li>
<li>
<p>Write the resulting text to a new (hard-coded) file</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should by now be familiar with most of the code in the script. The key new feature is the <code>setText()</code> method, which allows you to easily write text to a file. If the file doesn&#8217;t exist, it gets created. Otherwise, its content is overwritten by the string you provide. The method also closes the file automatically, so you don&#8217;t have to worry about leaving file handles open.</p>
</div>
<div class="paragraph">
<p>This works well for simple cases, but you often want to write to a file in chunks. Imagine you want to read records from a database table, perhaps process them, and then generate a CSV file containing one line per record. You could create the CSV in memory as a string and then write it out using <code>setText()</code>, but this is an inefficient use of memory and could take noticeably longer than writing each line to the file as you go. It depends on how many records you have.</p>
</div>
<div class="paragraph">
<p>Fortunately, Groovy provides several convenience methods for writing to a file on an as-you-go basis. I&#8217;m using <code>withPrintWriter()</code> in the next example to do exactly that, while also ensuring that the underlying file is closed regardless of whether my code throws an exception or not. The script takes a path to a directory and then generates a CSV file containing the filename, file size, and creation date for each file in that directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">static</span> <span class="include">java.time.format.DateTimeFormatter.ISO_OFFSET_DATE_TIME</span>

<span class="keyword">import</span> <span class="include">java.nio.file.Files</span>
<span class="keyword">import</span> <span class="include">java.nio.file.FileSystems</span> <span class="keyword">as</span> <span class="class">FS</span>
<span class="keyword">import</span> <span class="include">java.nio.file.Path</span>
<span class="keyword">import</span> <span class="include">java.time.ZoneId</span>                                      <b class="conum">(1)</b>

<span class="keyword">if</span> (args.size() != <span class="integer">1</span>) {
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Incorrect number of arguments.</span><span class="delimiter">&quot;</span></span>
    println <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">USAGE: filesReport DIR_PATH</span><span class="delimiter">&quot;</span></span>
    <span class="predefined-type">System</span>.exit(<span class="integer">1</span>)
}

<span class="directive">final</span> dirPath = FS.default.getPath(args[<span class="integer">0</span>])
<span class="directive">final</span> files = Files.list(dirPath)

<span class="directive">final</span> outFile = FS.default.getPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">files.csv</span><span class="delimiter">&quot;</span></span>)
outFile.withPrintWriter(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>) { writer -&gt;                 <b class="conum">(2)</b>
    <span class="keyword">for</span> (path <span class="keyword">in</span> files) {
        writer.println(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>path.fileName<span class="inline-delimiter">}</span></span><span class="content">, </span><span class="inline"><span class="inline-delimiter">${</span>Files.size(path)<span class="inline-delimiter">}</span></span><span class="content">, </span><span class="inline"><span class="inline-delimiter">${</span>getCreationDate(path)<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    }
}

println <span class="string"><span class="delimiter">&quot;</span><span class="content">Written report to </span><span class="inline"><span class="inline-delimiter">${</span>outFile<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>

<span class="predefined-type">String</span> getCreationDate(Path path) {
    <span class="directive">final</span> creationInstant = Files.getAttribute(path, <span class="string"><span class="delimiter">&quot;</span><span class="content">creationTime</span><span class="delimiter">&quot;</span></span>).toInstant()
    <span class="keyword">return</span> ISO_OFFSET_DATE_TIME.format(creationInstant.atZone(ZoneId.systemDefault()))
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Use the Java 8+ Date &amp; Time API</p>
</li>
<li>
<p>Generate the CSV file, with one line per source file</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This example doesn&#8217;t have many lines, but it does introduce two important features:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Java 8+ Date and Time API</p>
</li>
<li>
<p>Closures</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the new API.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dates_and_time">4.2. Dates and time</h3>
<div class="paragraph">
<p>Before Java 8, developers either got by with the <code>java.util.Date</code> and <code>java.util.Calendar</code> classes, or they used a third-party library called Joda Time. The latter was often the only choice for even moderately complex date and time work because the core JDK classes were awkward to use and underpowered.</p>
</div>
<div class="paragraph">
<p>The Date and Time API brings coherence to working with dates in Java. Simple things are often easier to accomplish than with the old <code>Date</code> class, while you also gain greater control with more complex requirements. Still, the <code>Date</code> class should work just fine for the file creation dates in our example. So why use the <code>java.time.*</code> classes? For two reasons. First, the file NIO API gives us a <code>java.time.Instant</code> value rather than a <code>java.util.Date</code>. Second, I think you should prioritize the Date and Time API over <code>java.util.Date</code> for your own code because it&#8217;s a significant improvement over the older API. For example, the core classes are immutable and thread safe, unlike <code>Date</code> and <code>Calendar</code>.</p>
</div>
<div class="paragraph">
<p>Figure xxx shows you the most relevant classes of the Date and Time API for right now. The <code>Instant</code> class represents a fixed point in time, independent of calendars and dates. If people around the globe retrieved the current time as an <code>Instant</code> at the same time, they should all get the same value, Of course, this is unlikely as there will almost certainly be variations between the system clocks on their computers. But that&#8217;s the ideal.</p>
</div>
<div class="paragraph">
<p>The <code>java.time.LocalDateTime</code> class is different in that it represents a (Gregorian) calendar date and time, such as New Year&#8217;s Day (1st January for any given year). This is not a fixed point in time because it depends on the time zone you&#8217;re interested in. New Year&#8217;s Day hits Australia well before the west coast of America. To correlate a date and time to an <code>Instant</code>, you need to use either <code>java.time.ZonedDateTime</code> or <code>java.time.OffsetTimeZone</code>, both of which incorporate the time zone information.</p>
</div>
<div class="paragraph">
<p>It&#8217;s often hard work dealing with calendars and keeping track of time zones, but we&#8217;re fortunate that the API makes life easy for our simple use case. The idea is to store the file creation date in the CSV file as an ISO 8601 date rather than an instant. To do that, we want to format the <code>Instant</code> we get from the <code>Files</code> class. The date formatters require dates rather than instants, though, so we use the <code>Instant.atZone()</code> method to perform the conversion using the system&#8217;s current time zone. We could also perform the conversion using the UTC time zone if we wanted. It all depends on whether we&#8217;re interested in which time zone the file was created in. For server-side work, I&#8217;d recommend almost always using UTC.</p>
</div>
<div class="paragraph">
<p>The Date and Time API brings more to the table than just these classes. Durations and periods allow you to readily calculate deadlines and reminders among other things. Overall, it&#8217;s a richer API than we had previously in the JDK without it being laboriously hard to work with.</p>
</div>
<div class="paragraph">
<p>I now want to go onto the second feature the script introduces: closures.</p>
</div>
</div>
<div class="sect2">
<h3 id="_closures">4.3. Closures</h3>
<div class="paragraph">
<p>Developers start using Groovy for a variety of reasons. I started because it was the language of the Grails web framework. But if we could narrow down why people then stayed with Groovy to a single language feature, I&#8217;m convinced it would be closures. It&#8217;s fairly easy these days to explain the basics of them because most of the popular languages have comparable features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ruby code blocks</p>
</li>
<li>
<p>Javascript functions</p>
</li>
<li>
<p>Java 8 lambdas</p>
</li>
<li>
<p>Python functions and lambdas</p>
</li>
<li>
<p>C# lambda expressions and anonymous functions</p>
</li>
<li>
<p>Scala functions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These aren&#8217;t all exactly the same feature, but they do allow for higher-order functions. If you&#8217;re not familiar with this term, it means that functions can themselves be arguments to other functions. Consider the example of filtering a list of words. You might want all the words that start with the letter 'p'. You might instead be interested words longer than 5 letters. Or perhaps you just want to remove all swear words using a dictionary. The only difference between each of these requirements is the filter constraint. Does the word start with a particular letter? Is it longer than a particular value? The algorithm for filtering the list is always the same, it&#8217;s only the constraint that changes.</p>
</div>
<div class="paragraph">
<p>That constraint can be implemented as a standalone predicate function, i.e. a function that returns <code>true</code> or <code>false</code>. Let&#8217;s see what this looks like in Groovy code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="directive">final</span> swearWords = [<span class="string"><span class="delimiter">&quot;</span><span class="content">flabbergasted</span><span class="delimiter">&quot;</span></span>] <span class="keyword">as</span> <span class="predefined-type">Set</span>
<span class="directive">final</span> words = [<span class="string"><span class="delimiter">&quot;</span><span class="content">orange</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sit</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">profit</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">flabbergasted</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">honorific</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">proposal</span><span class="delimiter">&quot;</span></span>]

println words.findAll({ word -&gt; word.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">p</span><span class="delimiter">&quot;</span></span>) })
println words.findAll({ word -&gt; word.size() &gt; <span class="integer">5</span> })
println words.findAll({ word -&gt; !swearWords.contains(word) })</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>findAll()</code> method is a Groovy JDK extension that performs collection filtering. In each of the above calls, it effectively applies the given predicate function (in this case a closure) to each word in the list and only retains the word if the function returns <code>true</code>. You can run the example to see the result.</p>
</div>
<div class="paragraph">
<p>The basic form of a closure is the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{ &lt;args&gt; -&gt; &lt;function body&gt; }</pre>
</div>
</div>
<div class="paragraph">
<p>So the curly braces delimit the closure literal, similar to the way square brackets delimit lists and maps. This can be a bit confusing because methods, loops, and conditions use curly braces as well. I generally ask myself this: are the curly braces part of an assignment or a method <em>call</em>? If so, then I have a closure. Assignments are easy to pick out:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>def predicateFn = { word -&gt; word.startsWith("p") }</pre>
</div>
</div>
<div class="paragraph">
<p>Method calls tend to be harder to identify because Groovy supports several syntaxes. I&#8217;ll explain shortly, but first, one question you may be asking yourself is where the <code>word</code> argument comes from. How does it work? It&#8217;s important to understand that a closure&#8217;s argument list behaves just the same as a method&#8217;s. In other words, <code>word</code> only exists within the context of the closure itself. It&#8217;s the responsibility of the <code>findAll()</code> method to pass each word as the argument when calling the closure.</p>
</div>
<div class="paragraph">
<p>To see what I mean, you can try invoking the closure yourself:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>def predicateFn = { word -&gt; word.startsWith("p") }
predicateFn.call("petals")</pre>
</div>
</div>
<div class="paragraph">
<p>Executing this in the Groovy console will show a result of <code>true</code>, because "petal" starts with a 'p'. What happens if you try to call the closure with more than one argument? The following results in a <code>MissingMethodException</code> for <code>call()</code> because the number of arguments don&#8217;t match:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>def predicateFn = { word -&gt; word.startsWith("p") }
predicateFn.call("petals", "badarg")</pre>
</div>
</div>
<div class="paragraph">
<p>If it&#8217;s easy to identify a closure that&#8217;s assigned to a variable, why is it harder when the closure is an argument of a method call? Let&#8217;s look at the first <code>findAll()</code> call from the list filtering example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>words.findAll({ word -&gt; word.startsWith("p") })</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s clear that <code>findAll()</code> is a method call because of the parentheses and the closure is defined within the parentheses. This makes the closure definition relatively obvious. But this is an uncommon syntax. The following are all more common alternatives:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>words.findAll() { word -&gt; word.startsWith("p") }
words.findAll { word -&gt; word.startsWith("p") }
words.findAll { word -&gt;
    word.startsWith("p")
}</pre>
</div>
</div>
<div class="paragraph">
<p>Of these, the second is probably the most common and it doesn&#8217;t even have any parentheses at all! What&#8217;s going on? This is simply syntax sugar for a very specific case. If the closure is the last (or only) argument of a method, it can be defined after the parentheses. If it&#8217;s the only argument, it&#8217;s common to dispense with the parentheses entirely.</p>
</div>
<div class="paragraph">
<p>Given this information about closures, can you identify the one in the earlier example where we created a CSV file from a directory listing? If you remember, the script writes the lines of text to the file using the <code>withPrintWriter()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
final outFile = FS.default.getPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">files.csv</span><span class="delimiter">&quot;</span></span>)
outFile.withPrintWriter(<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>) { writer -&gt;
    <span class="keyword">for</span> (path <span class="keyword">in</span> files) {
        writer.println(<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>path.fileName<span class="inline-delimiter">}</span></span><span class="content">, </span><span class="inline"><span class="inline-delimiter">${</span>Files.size(path)<span class="inline-delimiter">}</span></span><span class="content">, </span><span class="inline"><span class="inline-delimiter">${</span>getCreationDate(path)<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
    }
}
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The closure begins with <code>{ writer &#8594; &#8230;&#8203;</code>. Under the hood, <code>withPrintWriter()</code> creates or opens the target file and creates a <code>java.io.PrintWriter</code> for it using the character encoding specified by the first argument. It then calls the second argument - the closure - passing the newly created writer as it&#8217;s argument. When the closure returns or throws an exception, <code>withPrintWriter()</code> closes the file. For Java developers, it&#8217;s worth noting that this is the Groovy alternative to Java&#8217;s <em>try-with-resources</em> statement, as that syntax isn&#8217;t supported by Groovy.</p>
</div>
<div class="paragraph">
<p>A good way to learn and understand something is through plenty of examples. Two (filtering and writing to a file) aren&#8217;t really sufficient. To rectify that, I&#8217;m going to revisit some examples from earlier chapters and try to rewrite them using closures where appropriate. This should give you an idea of an alternate approach to thinking about coding problems and how to solve them.</p>
</div>
</div>
<div class="sect2">
<h3 id="_revisiting_earlier_examples">4.4. Revisiting earlier examples</h3>
<div class="paragraph">
<p>A lot of the examples you saw in the previous chapter have more concise and readable implementations once you start thinking in terms of higher order functions. Take the example for counting the number of vowels in a string. Instead of reaching immediately for a loop to solve the problem, think about what we want to achieve: counting characters. Which characters? Vowels. This is a similar problem to filtering a word list, except this time the algorithm is counting. The predicate simply determines whether a particular character should be counted or not. Is there a method available to do this?</p>
</div>
<div class="paragraph">
<p>If you check out the Groovy JDK documentation, you&#8217;ll find a <code>count()</code> method for <code>CharSequence</code>. The problem is that it only counts occurences of a specified string. What we need is the <code>Iterable.count(Closure)</code> method (the <code>groovy.lang.Closure</code> type is one way to identify a method that accepts closure arguments). Since <code>CharSequence</code> is not an <code>Iterable</code>, we first have to convert it to one using <code>iterator()</code>. We can then perform the count, as demonstrated here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> text = <span class="string"><span class="delimiter">&quot;</span><span class="content">Jack Rabbit Slims Twist Contest</span><span class="delimiter">&quot;</span></span>

<span class="directive">final</span> vowels = <span class="string"><span class="delimiter">&quot;</span><span class="content">aeiou</span><span class="delimiter">&quot;</span></span>
<span class="directive">final</span> vowelCount = text.iterator().count { vowels.contains(<span class="local-variable">it</span>.toLowerCase()) }

println <span class="string"><span class="delimiter">&quot;</span><span class="content">Number of vowels: </span><span class="delimiter">&quot;</span></span> + vowelCount</code></pre>
</div>
</div>
<div class="paragraph">
<p>What was originally 5 lines of a loop is now a single line. The example is also easier to reason about because the code is no longer cluttered with the mechanics of how to count the vowels. The focus here is <em>what</em> we want to achieve, not <em>how</em>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Implicit closure argument</div>
<div class="paragraph">
<p>One new element introduced by the previous example is the lack of an explicit argument for the <code>count()</code> closure. There&#8217;s no <code>&#8594;</code> that separates the argument list from the closure body. This is a special syntax that&#8217;s useful for very short closure implementations, typically one-liners. If you don&#8217;t specify an argument list, an implicit argument called <code>it</code> becomes available.</p>
</div>
<div class="paragraph">
<p>The implicit variable form only makes sense for methods that pass a single argument to the closure, such as <code>each()</code>, <code>collect()</code>, and <code>count()</code>. It also works with methods that pass no arguments at all, but then <code>it</code> will be <code>null</code>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>One thing you&#8217;ll quickly realise is how useful closures are in the world of collections. Consider the <a href="#wordStats">first example of section 3.2</a> [xcheck] calculates some statistics about a list of words using a loop. Although the implementation is efficient in terms of there only being a single loop, it&#8217;s not obvious at first glance what it&#8217;s trying to achieve.</p>
</div>
<div class="paragraph">
<p>A better approach in terms of code comprehension is to use some Groovy JDK extension methods for calculating the maximum, minimum and sum of values in a collection. The key point is that we&#8217;re not after the maximum word in this case - you could interpret this as the last word alphabetically perhaps - but the longest word. That&#8217;s where closures come in, as you can see from this alternate implementation of that example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="directive">final</span> words = [<span class="string"><span class="delimiter">&quot;</span><span class="content">orange</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">sit</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">flabbergasted</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">honorific</span><span class="delimiter">&quot;</span></span>]

println <span class="string"><span class="delimiter">&quot;</span><span class="content">Min word length:  </span><span class="inline"><span class="inline-delimiter">${</span>words.min { <span class="local-variable">it</span>.size() }.size()<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>         <b class="conum">(1)</b>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Max word length:  </span><span class="inline"><span class="inline-delimiter">${</span>words.max { <span class="local-variable">it</span>.size() }.size()<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
println <span class="string"><span class="delimiter">&quot;</span><span class="content">Avg word length:  </span><span class="inline"><span class="inline-delimiter">${</span>words.sum { <span class="local-variable">it</span>.size() } / words.size()<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><code>min()</code> and <code>max()</code> return the relevant collection element, i.e. a word in this case, so we need to call <code>size()</code> again to get its length</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In other words, we can specify exactly what property of the values in the collection we&#8217;re interested in by passing a closure to <code>min()</code>, <code>max()</code>, and <code>sum()</code> that extracts the relevant information. If we were interested in the number of vowels in the words instead, we could implement a <code>vowelCount()</code> method and use that from the closure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
println words.sum { vowelCount(<span class="local-variable">it</span>) }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The last example I want to revisit is the method for <a href="#powersOfTwo">calculating the power of twos</a>. I originally showed you an example based on a for loop, but let&#8217;s now take a different tack. Consider what result we want: a list of elements of the form 2<sup>x</sup>, where <code>x</code> is a range of numbers 0 to <code>n</code>. Given a sequence of numbers (<code>0..n</code>), applying the function 2<sup>x</sup> to each of the numbers in that sequence will generate a new sequence containing the required powers of two.</p>
</div>
<div class="paragraph">
<p>In code form, this looks like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">List</span> powersOfTwo(<span class="type">int</span> n) {
    <span class="keyword">return</span> (<span class="integer">0</span>..n).collect { <span class="integer">2</span> ** <span class="local-variable">it</span> }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>collect()</code> method is a general way of mapping the elements in one sequence to a new sequence. For example a list of words to a list of their lengths. Or sequence of integers to a sequence of their doubles. The actual mapping is defined by the closure, which acts as the mapping function.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re new to this style of programming, you may wonder how useful such a method could be in your day-to-day development. I think you&#8217;ll find you use it regularly, along with many of the other closure-based extensions to the JDK. That&#8217;s certainly been my experience, particularly as we often work a lot with collections.</p>
</div>
<div class="paragraph">
<p>There is one complication to this whole area of Groovy. Java originally had nothing like the <code>collect()</code> method prior to Java 8, but that all changed with the introduction of lambda functions and the Streams API. You now have an alternative. Here&#8217;s a Groovy version of the powers of two method using that API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">java.util.stream.Collectors</span>

<span class="predefined-type">List</span> powersOfTwo(<span class="type">int</span> n) {
    <span class="keyword">return</span> (<span class="integer">0</span>..n).stream().map { <span class="integer">2</span> ** <span class="local-variable">it</span> }.collect(Collectors.toList())
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are several important differences between this example and the previous one:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You have to convert a collection to a stream before you can use the functional methods</p>
</li>
<li>
<p>Java&#8217;s <code>map()</code> method is equivalent to Groovy&#8217;s <code>collect()</code></p>
</li>
<li>
<p>Use Java&#8217;s <code>collect()</code> method to convert a stream back to a collection</p>
</li>
<li>
<p>Java&#8217;s streams are lazy (unlike collections), so you can use them to work with infinite sequences</p>
</li>
<li>
<p>You can use a Groovy closure wherever Java 8 allows a lambda function</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So which API should you use? The Groovy Collections extensions or Java 8&#8217;s Streams API? If you have the option, I think the Streams API is more flexible and has more standard names for many of its methods (<code>map()</code> vs <code>collect()</code>, <code>filter()</code> vs <code>findAll()</code>, etc.). They are also type safe, which can be very useful if you like to use the <code>@TypeChecked</code> or <code>@CompileStatic</code> annotations that I discuss later [xcheck] or like your IDE to know what the types of the closure arguments are without explicitly declaring them. The main cost is the small additional complexity of converting to and fro between collections and streams.</p>
</div>
<div class="paragraph">
<p>Ultimately, both APIs provide an extra avenue of expressiveness for your code. If both satisfy a set of given requirements, just use the one that you&#8217;re most comfortable with.</p>
</div>
<div class="paragraph">
<p>I hope I&#8217;ve given you a good idea of just what you can achieve with Groovy when it comes to scripting, and how easy it can be. I&#8217;ve touched on the filesystem and date APIs and explored collections a bit further with closures. All that&#8217;s left for you to do is explore the API documentation yourself now that you have the information you need to navigate those waters. I&#8217;m also hoping that you are at least starting to get a grasp of what closures are and how they can help. You will find extensive use of them throughout this book and in most Groovy code you&#8217;ll come across, so it&#8217;s an important topic.</p>
</div>
<div class="paragraph">
<p>In the next chapter I want to move beyond simple scripting and see how you can incorporate Groovy into a project, such as an command line or web application.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-08-15 07:18:37 BST
</div>
</div>
</body>
</html>